<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Horoz ƒ∞mparatorluƒüu: Cyber Arena</title>
  <style>
    :root {
      --bg-dark: #0a0a0f;
      --bg-card: #12121a;
      --bg-card-hover: #1a1a25;
      --neon-pink: #ff006e;
      --neon-cyan: #00f5ff;
      --neon-green: #39ff14;
      --neon-yellow: #ffd000;
      --neon-purple: #bf00ff;
      --neon-orange: #ff6b00;
      --text-primary: #ffffff;
      --text-secondary: #8888aa;
      --text-muted: #555566;
      --danger: #ff3366;
      --success: #00ff88;
      --warning: #ffaa00;
      --border-subtle: rgba(255,255,255,0.08);
      --shadow-neon: 0 0 20px rgba(0,245,255,0.3);
      --shadow-pink: 0 0 20px rgba(255,0,110,0.3);
      --gradient-fire: linear-gradient(135deg, #ff6b00, #ff006e);
      --gradient-ice: linear-gradient(135deg, #00f5ff, #0066ff);
      --gradient-earth: linear-gradient(135deg, #8B4513, #228B22);
      --gradient-air: linear-gradient(135deg, #E0E0E0, #87CEEB);
      --gradient-shadow: linear-gradient(135deg, #4B0082, #000000);
      --gradient-cyber: linear-gradient(135deg, #ff006e, #00f5ff);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
    }

    html, body {
      height: 100%;
      overflow: hidden;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: var(--bg-dark);
      color: var(--text-primary);
      user-select: none;
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(ellipse at 20% 20%, rgba(255,0,110,0.1) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(0,245,255,0.1) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }

    .app-container {
      position: relative;
      z-index: 1;
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* Header */
    .header {
      background: linear-gradient(180deg, var(--bg-card) 0%, transparent 100%);
      padding: calc(env(safe-area-inset-top, 20px) + 10px) 16px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
      z-index: 100;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .player-avatar {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: var(--gradient-cyber);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      border: 2px solid var(--neon-cyan);
      box-shadow: var(--shadow-neon);
    }

    .player-info {
      display: flex;
      flex-direction: column;
    }

    .player-name {
      font-weight: 700;
      font-size: 14px;
      color: var(--text-primary);
    }

    .player-rank {
      font-size: 11px;
      color: var(--neon-cyan);
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .header-resources {
      display: flex;
      gap: 12px;
    }

    .resource {
      display: flex;
      align-items: center;
      gap: 6px;
      background: var(--bg-card);
      padding: 6px 12px;
      border-radius: 20px;
      border: 1px solid var(--border-subtle);
    }

    .resource-icon {
      font-size: 16px;
    }

    .resource-value {
      font-weight: 700;
      font-size: 13px;
    }

    .resource-energy .resource-value { color: var(--neon-yellow); }
    .resource-crystal .resource-value { color: var(--neon-cyan); }

    /* Screens */
    .screen {
      display: none;
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      padding: 0 16px 100px;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
    }

    .screen.active {
      display: block;
    }

    .screen::-webkit-scrollbar {
      width: 4px;
    }

    .screen::-webkit-scrollbar-track {
      background: transparent;
    }

    .screen::-webkit-scrollbar-thumb {
      background: var(--neon-pink);
      border-radius: 2px;
    }

    /* Section Headers */
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 20px 0 12px;
    }

    .section-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section-title::before {
      content: '';
      width: 4px;
      height: 20px;
      background: var(--gradient-cyber);
      border-radius: 2px;
    }

    .section-action {
      color: var(--neon-cyan);
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
    }

    /* Cards */
    .card {
      background: var(--bg-card);
      border-radius: 16px;
      border: 1px solid var(--border-subtle);
      overflow: hidden;
      position: relative;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--gradient-cyber);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .card:active::before {
      opacity: 1;
    }

    /* Economy Banner */
    .economy-banner {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 16px;
      border: 1px solid var(--border-subtle);
      position: relative;
      overflow: hidden;
    }

    .economy-banner::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent 40%, rgba(0,245,255,0.05) 50%, transparent 60%);
      animation: economyShimmer 3s infinite linear;
    }

    @keyframes economyShimmer {
      0% { transform: translateX(-100%) rotate(45deg); }
      100% { transform: translateX(100%) rotate(45deg); }
    }

    .economy-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      position: relative;
      z-index: 1;
    }

    .economy-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-secondary);
    }

    .economy-status {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      padding: 4px 10px;
      border-radius: 12px;
      background: rgba(0,255,136,0.15);
      color: var(--success);
    }

    .economy-status.unstable {
      background: rgba(255,170,0,0.15);
      color: var(--warning);
    }

    .economy-status.critical {
      background: rgba(255,51,102,0.15);
      color: var(--danger);
    }

    .economy-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      position: relative;
      z-index: 1;
    }

    .economy-stat {
      text-align: center;
    }

    .economy-stat-value {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-primary);
    }

    .economy-stat-label {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 2px;
    }

    .economy-progress {
      margin-top: 12px;
      position: relative;
      z-index: 1;
    }

    .progress-bar {
      height: 8px;
      background: var(--bg-dark);
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: var(--gradient-cyber);
      border-radius: 4px;
      transition: width 0.5s ease;
    }

    .progress-fill.warning {
      background: var(--warning);
    }

    .progress-fill.danger {
      background: var(--danger);
    }

    /* Shield Banner */
    .shield-banner {
      background: linear-gradient(135deg, rgba(0,245,255,0.1), rgba(255,0,110,0.1));
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 16px;
      border: 1px solid var(--neon-cyan);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .shield-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .shield-icon {
      font-size: 32px;
      animation: shieldPulse 2s infinite;
    }

    @keyframes shieldPulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.1); opacity: 0.8; }
    }

    .shield-text h3 {
      font-size: 14px;
      color: var(--neon-cyan);
      margin-bottom: 2px;
    }

    .shield-text p {
      font-size: 12px;
      color: var(--text-secondary);
    }

    .shield-inactive {
      background: linear-gradient(135deg, rgba(255,51,102,0.1), rgba(255,170,0,0.1));
      border-color: var(--warning);
    }

    .shield-inactive .shield-icon {
      animation: none;
      opacity: 0.5;
    }

    .shield-inactive .shield-text h3 {
      color: var(--warning);
    }

    /* Quick Actions */
    .quick-actions {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-bottom: 20px;
    }

    .quick-action {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 20px 16px;
      text-align: center;
      border: 1px solid var(--border-subtle);
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
      overflow: hidden;
    }

    .quick-action:active {
      transform: scale(0.98);
      background: var(--bg-card-hover);
    }

    .quick-action-icon {
      font-size: 32px;
      margin-bottom: 8px;
      display: block;
    }

    .quick-action-title {
      font-size: 14px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .quick-action-desc {
      font-size: 11px;
      color: var(--text-secondary);
    }

    .quick-action-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      background: var(--danger);
      color: white;
      font-size: 10px;
      font-weight: 700;
      padding: 2px 6px;
      border-radius: 8px;
    }

    .quick-action.arena {
      background: linear-gradient(135deg, rgba(255,0,110,0.15), rgba(255,107,0,0.15));
      border-color: var(--neon-pink);
    }

    .quick-action.training {
      background: linear-gradient(135deg, rgba(0,245,255,0.15), rgba(0,102,255,0.15));
      border-color: var(--neon-cyan);
    }

    .quick-action.bazaar {
      background: linear-gradient(135deg, rgba(255,208,0,0.15), rgba(255,170,0,0.15));
      border-color: var(--neon-yellow);
    }

    .quick-action.city {
      background: linear-gradient(135deg, rgba(57,255,20,0.15), rgba(0,255,136,0.15));
      border-color: var(--neon-green);
    }

    /* Rooster Cards */
    .roosters-grid {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .rooster-card {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 16px;
      border: 1px solid var(--border-subtle);
      display: flex;
      gap: 16px;
      position: relative;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.2s;
    }

    .rooster-card:active {
      transform: scale(0.99);
      background: var(--bg-card-hover);
    }

    .rooster-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      opacity: 0.8;
    }

    .rooster-card.element-fire::before { background: var(--gradient-fire); }
    .rooster-card.element-ice::before { background: var(--gradient-ice); }
    .rooster-card.element-earth::before { background: var(--gradient-earth); }
    .rooster-card.element-air::before { background: var(--gradient-air); }
    .rooster-card.element-shadow::before { background: var(--gradient-shadow); }

    .rooster-avatar {
      width: 80px;
      height: 80px;
      border-radius: 12px;
      background: var(--bg-dark);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      overflow: hidden;
    }

    .rooster-avatar svg {
      width: 100%;
      height: 100%;
    }

    .rooster-info {
      flex: 1;
      min-width: 0;
    }

    .rooster-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 8px;
    }

    .rooster-name {
      font-size: 16px;
      font-weight: 700;
      color: var(--text-primary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .rooster-level {
      background: var(--gradient-cyber);
      color: white;
      font-size: 11px;
      font-weight: 700;
      padding: 3px 8px;
      border-radius: 10px;
      flex-shrink: 0;
    }

    .rooster-breed {
      font-size: 12px;
      color: var(--text-secondary);
      margin-bottom: 8px;
    }

    .rooster-breed span {
      color: var(--neon-cyan);
      font-weight: 600;
    }

    .rooster-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
    }

    .rooster-stat {
      text-align: center;
    }

    .rooster-stat-value {
      font-size: 14px;
      font-weight: 700;
      color: var(--text-primary);
    }

    .rooster-stat-label {
      font-size: 10px;
      color: var(--text-muted);
    }

    .rooster-status {
      display: flex;
      gap: 8px;
      margin-top: 8px;
    }

    .status-badge {
      font-size: 10px;
      padding: 3px 8px;
      border-radius: 8px;
      font-weight: 600;
    }

    .status-badge.ready {
      background: rgba(0,255,136,0.15);
      color: var(--success);
    }

    .status-badge.tired {
      background: rgba(255,170,0,0.15);
      color: var(--warning);
    }

    .status-badge.injured {
      background: rgba(255,51,102,0.15);
      color: var(--danger);
    }

    /* Element Icons */
    .element-icon {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
    }

    .element-icon.fire { background: var(--gradient-fire); }
    .element-icon.ice { background: var(--gradient-ice); }
    .element-icon.earth { background: var(--gradient-earth); }
    .element-icon.air { background: var(--gradient-air); }
    .element-icon.shadow { background: var(--gradient-shadow); }

    /* Arena Screen */
    .arena-modes {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .arena-mode {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 20px;
      border: 1px solid var(--border-subtle);
      display: flex;
      align-items: center;
      gap: 16px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .arena-mode:active {
      transform: scale(0.98);
      background: var(--bg-card-hover);
    }

    .arena-mode-icon {
      width: 60px;
      height: 60px;
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      flex-shrink: 0;
    }

    .arena-mode.street .arena-mode-icon {
      background: linear-gradient(135deg, #4a4a4a, #2a2a2a);
    }

    .arena-mode.ranked .arena-mode-icon {
      background: linear-gradient(135deg, #ffd700, #ff8c00);
    }

    .arena-mode.tournament .arena-mode-icon {
      background: linear-gradient(135deg, #ff006e, #bf00ff);
    }

    .arena-mode.boss .arena-mode-icon {
      background: linear-gradient(135deg, #ff0000, #8b0000);
    }

    .arena-mode-info {
      flex: 1;
    }

    .arena-mode-title {
      font-size: 16px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .arena-mode-desc {
      font-size: 12px;
      color: var(--text-secondary);
      margin-bottom: 8px;
    }

    .arena-mode-rewards {
      display: flex;
      gap: 12px;
    }

    .arena-reward {
      font-size: 11px;
      color: var(--neon-cyan);
      display: flex;
      align-items: center;
      gap: 4px;
    }

    /* Combat Screen */
    .combat-container {
      height: 100%;
      display: flex;
      flex-direction: column;
      padding-bottom: 20px;
    }

    .combat-header {
      text-align: center;
      padding: 16px 0;
    }

    .combat-round {
      font-size: 12px;
      color: var(--text-secondary);
      margin-bottom: 4px;
    }

    .combat-title {
      font-size: 24px;
      font-weight: 700;
      background: var(--gradient-cyber);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .combat-arena {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 20px;
      padding: 20px 0;
    }

    .fighter {
      background: var(--bg-card);
      border-radius: 20px;
      padding: 20px;
      border: 2px solid var(--border-subtle);
      position: relative;
      overflow: hidden;
    }

    .fighter.player {
      border-color: var(--neon-cyan);
      box-shadow: 0 0 30px rgba(0,245,255,0.2);
    }

    .fighter.opponent {
      border-color: var(--neon-pink);
      box-shadow: 0 0 30px rgba(255,0,110,0.2);
    }

    .fighter-inner {
      display: flex;
      gap: 16px;
      align-items: center;
    }

    .fighter-avatar {
      width: 80px;
      height: 80px;
      border-radius: 16px;
      background: var(--bg-dark);
      flex-shrink: 0;
      overflow: hidden;
    }

    .fighter-avatar svg {
      width: 100%;
      height: 100%;
    }

    .fighter-details {
      flex: 1;
    }

    .fighter-name {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .fighter-hp-bar {
      height: 16px;
      background: var(--bg-dark);
      border-radius: 8px;
      overflow: hidden;
      margin-bottom: 8px;
      position: relative;
    }

    .fighter-hp-fill {
      height: 100%;
      background: var(--success);
      transition: width 0.3s ease;
      border-radius: 8px;
    }

    .fighter-hp-fill.medium {
      background: var(--warning);
    }

    .fighter-hp-fill.low {
      background: var(--danger);
    }

    .fighter-hp-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 11px;
      font-weight: 700;
      color: white;
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    }

    .fighter-stats-row {
      display: flex;
      gap: 16px;
    }

    .fighter-stat-mini {
      font-size: 11px;
      color: var(--text-secondary);
    }

    .fighter-stat-mini span {
      color: var(--text-primary);
      font-weight: 600;
    }

    .combat-vs {
      text-align: center;
      font-size: 32px;
      font-weight: 900;
      color: var(--neon-pink);
      text-shadow: 0 0 20px var(--neon-pink);
      animation: vsPulse 1s infinite;
    }

    @keyframes vsPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    .combat-log {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 16px;
      max-height: 120px;
      overflow-y: auto;
      margin-bottom: 16px;
    }

    .combat-log-entry {
      font-size: 13px;
      color: var(--text-secondary);
      padding: 6px 0;
      border-bottom: 1px solid var(--border-subtle);
    }

    .combat-log-entry:last-child {
      border-bottom: none;
    }

    .combat-log-entry.critical {
      color: var(--neon-pink);
      font-weight: 600;
    }

    .combat-log-entry.heal {
      color: var(--success);
    }

    .rage-bar-container {
      margin-bottom: 16px;
    }

    .rage-bar-label {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      margin-bottom: 6px;
    }

    .rage-bar-label span:first-child {
      color: var(--neon-orange);
      font-weight: 600;
    }

    .rage-bar {
      height: 12px;
      background: var(--bg-dark);
      border-radius: 6px;
      overflow: hidden;
    }

    .rage-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--neon-orange), var(--neon-pink));
      transition: width 0.3s ease;
      border-radius: 6px;
    }

    .combat-actions {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .combat-action {
      padding: 16px;
      border-radius: 12px;
      border: none;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
    }

    .combat-action:active {
      transform: scale(0.95);
    }

    .combat-action.attack {
      background: var(--gradient-fire);
      color: white;
    }

    .combat-action.defend {
      background: var(--gradient-ice);
      color: white;
    }

    .combat-action.special {
      background: var(--gradient-shadow);
      color: white;
      grid-column: span 2;
    }

    .combat-action.special:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .combat-action-icon {
      font-size: 24px;
    }

    /* City Screen */
    .city-map {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .district {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 16px;
      border: 1px solid var(--border-subtle);
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
      overflow: hidden;
    }

    .district:active {
      transform: scale(0.98);
    }

    .district.conquered {
      border-color: var(--neon-green);
    }

    .district.conquered::after {
      content: '‚úì';
      position: absolute;
      top: 10px;
      right: 10px;
      background: var(--success);
      color: white;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 700;
    }

    .district-icon {
      font-size: 32px;
      margin-bottom: 8px;
    }

    .district-name {
      font-size: 14px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .district-difficulty {
      font-size: 11px;
      color: var(--text-secondary);
      margin-bottom: 8px;
    }

    .district-reward {
      font-size: 11px;
      color: var(--neon-cyan);
      display: flex;
      align-items: center;
      gap: 4px;
    }

    /* Training Screen */
    .training-options {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .training-option {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 20px;
      border: 1px solid var(--border-subtle);
      cursor: pointer;
      transition: all 0.2s;
    }

    .training-option:active {
      transform: scale(0.98);
      background: var(--bg-card-hover);
    }

    .training-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .training-title {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .training-icon {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }

    .training-icon.power { background: linear-gradient(135deg, #ff6b00, #ff006e); }
    .training-icon.speed { background: linear-gradient(135deg, #00f5ff, #0066ff); }
    .training-icon.stamina { background: linear-gradient(135deg, #39ff14, #00ff88); }
    .training-icon.recovery { background: linear-gradient(135deg, #ff69b4, #ff1493); }

    .training-name {
      font-size: 16px;
      font-weight: 700;
      color: var(--text-primary);
    }

    .training-cost {
      font-size: 13px;
      color: var(--neon-yellow);
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .training-desc {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: 12px;
    }

    .training-effect {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: var(--neon-green);
    }

    /* Market Screen */
    .market-categories {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
      overflow-x: auto;
      padding-bottom: 8px;
      -webkit-overflow-scrolling: touch;
    }

    .market-category {
      padding: 10px 20px;
      border-radius: 20px;
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      color: var(--text-secondary);
      font-size: 13px;
      font-weight: 600;
      white-space: nowrap;
      cursor: pointer;
      transition: all 0.2s;
    }

    .market-category.active {
      background: var(--gradient-cyber);
      color: white;
      border-color: transparent;
    }

    .market-items {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .market-item {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 16px;
      border: 1px solid var(--border-subtle);
      display: flex;
      gap: 16px;
      align-items: center;
    }

    .market-item-icon {
      width: 60px;
      height: 60px;
      border-radius: 12px;
      background: var(--bg-dark);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      flex-shrink: 0;
    }

    .market-item-info {
      flex: 1;
    }

    .market-item-name {
      font-size: 15px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .market-item-desc {
      font-size: 12px;
      color: var(--text-secondary);
    }

    .market-item-price {
      text-align: right;
    }

    .market-item-cost {
      font-size: 16px;
      font-weight: 700;
      color: var(--neon-cyan);
      display: flex;
      align-items: center;
      gap: 4px;
      margin-bottom: 8px;
    }

    .market-buy-btn {
      padding: 8px 16px;
      border-radius: 8px;
      border: none;
      background: var(--gradient-cyber);
      color: white;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
    }

    .market-buy-btn:active {
      transform: scale(0.95);
    }

    .market-buy-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Bazaar Screen - Ad Watching */
    .bazaar-banner {
      background: linear-gradient(135deg, rgba(255,208,0,0.2), rgba(255,107,0,0.2));
      border-radius: 16px;
      padding: 20px;
      text-align: center;
      margin-bottom: 20px;
      border: 1px solid var(--neon-yellow);
    }

    .bazaar-banner-icon {
      font-size: 48px;
      margin-bottom: 12px;
    }

    .bazaar-banner-title {
      font-size: 20px;
      font-weight: 700;
      color: var(--neon-yellow);
      margin-bottom: 8px;
    }

    .bazaar-banner-desc {
      font-size: 13px;
      color: var(--text-secondary);
    }

    .ad-options {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .ad-option {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 20px;
      border: 1px solid var(--border-subtle);
      cursor: pointer;
      transition: all 0.2s;
    }

    .ad-option:active {
      transform: scale(0.98);
      background: var(--bg-card-hover);
    }

    .ad-option-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .ad-option-title {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .ad-option-icon {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .ad-option-icon.crystal { background: linear-gradient(135deg, #00f5ff, #0066ff); }
    .ad-option-icon.energy { background: linear-gradient(135deg, #ffd000, #ff8c00); }
    .ad-option-icon.shield { background: linear-gradient(135deg, #39ff14, #00ff88); }
    .ad-option-icon.boost { background: linear-gradient(135deg, #ff006e, #bf00ff); }

    .ad-option-name {
      font-size: 16px;
      font-weight: 700;
      color: var(--text-primary);
    }

    .ad-option-reward {
      font-size: 14px;
      font-weight: 700;
      color: var(--neon-green);
    }

    .ad-option-desc {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: 12px;
    }

    .ad-option-progress {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .ad-option-count {
      font-size: 12px;
      color: var(--text-muted);
    }

    .ad-progress-bar {
      flex: 1;
      height: 6px;
      background: var(--bg-dark);
      border-radius: 3px;
      overflow: hidden;
    }

    .ad-progress-fill {
      height: 100%;
      background: var(--gradient-cyber);
      border-radius: 3px;
    }

    /* Tasks Screen */
    .tasks-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }

    .tasks-tab {
      flex: 1;
      padding: 12px;
      border-radius: 12px;
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      color: var(--text-secondary);
      font-size: 13px;
      font-weight: 600;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
    }

    .tasks-tab.active {
      background: var(--gradient-cyber);
      color: white;
      border-color: transparent;
    }

    .task-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .task-item {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 16px;
      border: 1px solid var(--border-subtle);
    }

    .task-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 12px;
    }

    .task-info {
      flex: 1;
    }

    .task-title {
      font-size: 15px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .task-desc {
      font-size: 12px;
      color: var(--text-secondary);
    }

    .task-reward {
      text-align: right;
    }

    .task-reward-value {
      font-size: 14px;
      font-weight: 700;
      color: var(--neon-cyan);
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .task-progress {
      margin-top: 12px;
    }

    .task-progress-bar {
      height: 8px;
      background: var(--bg-dark);
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 6px;
    }

    .task-progress-fill {
      height: 100%;
      background: var(--gradient-cyber);
      border-radius: 4px;
      transition: width 0.3s ease;
    }

    .task-progress-text {
      font-size: 11px;
      color: var(--text-muted);
      text-align: right;
    }

    .task-claim-btn {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: none;
      background: var(--gradient-cyber);
      color: white;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      margin-top: 12px;
    }

    .task-claim-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      background: var(--bg-dark);
    }

    .task-claim-btn:not(:disabled):active {
      transform: scale(0.98);
    }

    /* Bottom Navigation */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg-card);
      border-top: 1px solid var(--border-subtle);
      display: flex;
      padding: 8px 0 calc(8px + env(safe-area-inset-bottom, 0px));
      z-index: 1000;
    }

    .nav-item {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      padding: 8px 4px;
      background: none;
      border: none;
      color: var(--text-muted);
      font-size: 10px;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }

    .nav-item.active {
      color: var(--neon-pink);
    }

    .nav-item.active::before {
      content: '';
      position: absolute;
      top: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 30px;
      height: 3px;
      background: var(--gradient-cyber);
      border-radius: 0 0 3px 3px;
    }

    .nav-icon {
      font-size: 22px;
      line-height: 1;
    }

    .nav-label {
      font-weight: 600;
    }

    .nav-badge {
      position: absolute;
      top: 4px;
      right: 50%;
      transform: translateX(100%);
      background: var(--danger);
      color: white;
      font-size: 9px;
      font-weight: 700;
      min-width: 16px;
      height: 16px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 4px;
    }

    /* Toast Notifications */
    .toast-container {
      position: fixed;
      top: calc(env(safe-area-inset-top, 20px) + 70px);
      left: 16px;
      right: 16px;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      gap: 8px;
      pointer-events: none;
    }

    .toast {
      background: var(--bg-card);
      border: 1px solid var(--neon-cyan);
      border-radius: 12px;
      padding: 14px 18px;
      box-shadow: var(--shadow-neon);
      animation: toastIn 0.3s ease forwards;
      display: flex;
      align-items: center;
      gap: 12px;
      pointer-events: auto;
    }

    .toast.success {
      border-color: var(--success);
      box-shadow: 0 0 20px rgba(0,255,136,0.3);
    }

    .toast.error {
      border-color: var(--danger);
      box-shadow: 0 0 20px rgba(255,51,102,0.3);
    }

    .toast.warning {
      border-color: var(--warning);
      box-shadow: 0 0 20px rgba(255,170,0,0.3);
    }

    .toast-icon {
      font-size: 20px;
    }

    .toast-message {
      flex: 1;
      font-size: 14px;
      color: var(--text-primary);
    }

    @keyframes toastIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .toast.hiding {
      animation: toastOut 0.3s ease forwards;
    }

    @keyframes toastOut {
      to {
        opacity: 0;
        transform: translateY(-20px);
      }
    }

    /* Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.8);
      z-index: 10000;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .modal {
      background: var(--bg-card);
      border-radius: 20px;
      width: 100%;
      max-width: 360px;
      max-height: 80vh;
      overflow-y: auto;
      transform: scale(0.9);
      transition: transform 0.3s;
    }

    .modal-overlay.active .modal {
      transform: scale(1);
    }

    .modal-header {
      padding: 20px;
      border-bottom: 1px solid var(--border-subtle);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-title {
      font-size: 18px;
      font-weight: 700;
    }

    .modal-close {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--bg-dark);
      border: none;
      color: var(--text-secondary);
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-body {
      padding: 20px;
    }

    .modal-actions {
      padding: 20px;
      border-top: 1px solid var(--border-subtle);
      display: flex;
      gap: 12px;
    }

    .modal-btn {
      flex: 1;
      padding: 14px;
      border-radius: 12px;
      border: none;
      font-size: 15px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
    }

    .modal-btn:active {
      transform: scale(0.98);
    }

    .modal-btn.primary {
      background: var(--gradient-cyber);
      color: white;
    }

    .modal-btn.secondary {
      background: var(--bg-dark);
      color: var(--text-primary);
    }

    /* Ad Watching Simulation */
    .ad-simulation {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: #000;
      z-index: 20000;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .ad-simulation.active {
      display: flex;
    }

    .ad-content {
      text-align: center;
      padding: 40px;
    }

    .ad-icon {
      font-size: 80px;
      margin-bottom: 20px;
      animation: adPulse 1s infinite;
    }

    @keyframes adPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    .ad-title {
      font-size: 24px;
      font-weight: 700;
      color: white;
      margin-bottom: 12px;
    }

    .ad-timer {
      font-size: 48px;
      font-weight: 700;
      color: var(--neon-cyan);
      margin-bottom: 20px;
    }

    .ad-skip {
      padding: 12px 32px;
      border-radius: 25px;
      background: var(--gradient-cyber);
      border: none;
      color: white;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      opacity: 0.3;
      pointer-events: none;
      transition: all 0.3s;
    }

    .ad-skip.ready {
      opacity: 1;
      pointer-events: auto;
    }

    /* Result Screen */
    .result-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.9);
      z-index: 15000;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 40px;
    }

    .result-overlay.active {
      display: flex;
    }

    .result-icon {
      font-size: 80px;
      margin-bottom: 20px;
      animation: resultBounce 0.5s ease;
    }

    @keyframes resultBounce {
      0% { transform: scale(0); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }

    .result-title {
      font-size: 32px;
      font-weight: 900;
      margin-bottom: 8px;
      text-align: center;
    }

    .result-title.victory {
      color: var(--success);
      text-shadow: 0 0 30px var(--success);
    }

    .result-title.defeat {
      color: var(--danger);
      text-shadow: 0 0 30px var(--danger);
    }

    .result-subtitle {
      font-size: 16px;
      color: var(--text-secondary);
      margin-bottom: 30px;
      text-align: center;
    }

    .result-rewards {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 20px;
      width: 100%;
      max-width: 300px;
      margin-bottom: 30px;
    }

    .result-rewards-title {
      font-size: 14px;
      color: var(--text-secondary);
      text-align: center;
      margin-bottom: 16px;
    }

    .result-rewards-list {
      display: flex;
      justify-content: center;
      gap: 24px;
    }

    .result-reward-item {
      text-align: center;
    }

    .result-reward-icon {
      font-size: 28px;
      margin-bottom: 4px;
    }

    .result-reward-value {
      font-size: 18px;
      font-weight: 700;
      color: var(--neon-cyan);
    }

    .result-actions {
      display: flex;
      gap: 12px;
    }

    .result-btn {
      padding: 14px 32px;
      border-radius: 12px;
      border: none;
      font-size: 15px;
      font-weight: 700;
      cursor: pointer;
    }

    .result-btn.primary {
      background: var(--gradient-cyber);
      color: white;
    }

    .result-btn.secondary {
      background: var(--bg-card);
      color: var(--text-primary);
    }

    /* Animations */
    .hit-effect {
      animation: hitShake 0.3s ease;
    }

    @keyframes hitShake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }

    .critical-flash {
      animation: criticalFlash 0.5s ease;
    }

    @keyframes criticalFlash {
      0%, 100% { background: var(--bg-card); }
      50% { background: rgba(255,0,110,0.3); }
    }

    .level-up-effect {
      animation: levelUp 0.8s ease;
    }

    @keyframes levelUp {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); filter: brightness(1.5); }
      100% { transform: scale(1); }
    }

    /* Loading Spinner */
    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid var(--bg-dark);
      border-top-color: var(--neon-cyan);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Responsive */
    @media (max-width: 360px) {
      .quick-actions {
        grid-template-columns: 1fr;
      }
      
      .rooster-avatar {
        width: 64px;
        height: 64px;
      }
      
      .fighter-avatar {
        width: 60px;
        height: 60px;
      }
    }

    @media (min-width: 768px) {
      .screen {
        max-width: 480px;
        margin: 0 auto;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <!-- Header -->
    <header class="header" id="mainHeader">
      <div class="header-left">
        <div class="player-avatar" id="playerAvatar">üêì</div>
        <div class="player-info">
          <div class="player-name" id="playerName">Usta Mehmet</div>
          <div class="player-rank" id="playerRank">
            <span>‚≠ê</span> <span id="rankText">√áƒ±rak</span>
          </div>
        </div>
      </div>
      <div class="header-resources">
        <div class="resource resource-energy">
          <span class="resource-icon">‚ö°</span>
          <span class="resource-value" id="energyValue">500</span>
        </div>
        <div class="resource resource-crystal">
          <span class="resource-icon">üíé</span>
          <span class="resource-value" id="crystalValue">10</span>
        </div>
      </div>
    </header>

    <!-- Screens -->
    
    <!-- Home Screen -->
    <main class="screen active" id="screenHome">
      <!-- Economy Banner -->
      <div class="economy-banner">
        <div class="economy-header">
          <span class="economy-title">üåê Global Ekonomi</span>
          <span class="economy-status" id="economyStatus">
            <span>‚óè</span> <span id="stabilityText">Stabil</span>
          </span>
        </div>
        <div class="economy-stats">
          <div class="economy-stat">
            <div class="economy-stat-value" id="dailyPoolValue">10K</div>
            <div class="economy-stat-label">G√ºnl√ºk Havuz</div>
          </div>
          <div class="economy-stat">
            <div class="economy-stat-value" id="claimedValue">0</div>
            <div class="economy-stat-label">Toplanan</div>
          </div>
          <div class="economy-stat">
            <div class="economy-stat-value" id="stabilityValue">100%</div>
            <div class="economy-stat-label">Stabilite</div>
          </div>
        </div>
        <div class="economy-progress">
          <div class="progress-bar">
            <div class="progress-fill" id="economyProgressFill" style="width: 100%"></div>
          </div>
        </div>
      </div>

      <!-- Shield Banner -->
      <div class="shield-banner shield-inactive" id="shieldBanner">
        <div class="shield-info">
          <span class="shield-icon">üõ°Ô∏è</span>
          <div class="shield-text">
            <h3 id="shieldTitle">Koruma Kapalƒ±</h3>
            <p id="shieldDesc">Reklam izleyerek koruma aktifle</p>
          </div>
        </div>
        <button class="modal-btn primary" style="width: auto; padding: 10px 16px; font-size: 12px;" onclick="game.showBazaar()">
          Aktifle
        </button>
      </div>

      <!-- Quick Actions -->
      <div class="quick-actions">
        <div class="quick-action arena" onclick="game.navigate('arena')">
          <span class="quick-action-icon">‚öîÔ∏è</span>
          <div class="quick-action-title">Arena</div>
          <div class="quick-action-desc">D√∂v√º≈ü ba≈ülat</div>
          <span class="quick-action-badge" id="arenaEnergy">50‚ö°</span>
        </div>
        <div class="quick-action training" onclick="game.navigate('training')">
          <span class="quick-action-icon">üí™</span>
          <div class="quick-action-title">Antrenman</div>
          <div class="quick-action-desc">Horozunu geli≈ütir</div>
        </div>
        <div class="quick-action bazaar" onclick="game.navigate('bazaar')">
          <span class="quick-action-icon">üì∫</span>
          <div class="quick-action-title">Pazar</div>
          <div class="quick-action-desc">Reklam ile kazan</div>
          <span class="quick-action-badge" id="adCount">3</span>
        </div>
        <div class="quick-action city" onclick="game.navigate('city')">
          <span class="quick-action-icon">üèôÔ∏è</span>
          <div class="quick-action-title">≈ûehir</div>
          <div class="quick-action-desc">Mahalleleri fethet</div>
        </div>
      </div>

      <!-- My Roosters -->
      <div class="section-header">
        <h2 class="section-title">Horozlarƒ±m</h2>
        <span class="section-action" onclick="game.navigate('market')">Yeni Al ‚Üí</span>
      </div>
      <div class="roosters-grid" id="roostersList">
        <!-- Roosters will be dynamically inserted here -->
      </div>
    </main>

    <!-- Arena Screen -->
    <main class="screen" id="screenArena">
      <div class="section-header">
        <h2 class="section-title">Arena Modlarƒ±</h2>
      </div>
      <div class="arena-modes">
        <div class="arena-mode street" onclick="game.startCombat('street')">
          <div class="arena-mode-icon">ü•ä</div>
          <div class="arena-mode-info">
            <div class="arena-mode-title">Sokak D√∂v√º≈ü√º</div>
            <div class="arena-mode-desc">Rastgele rakiple e≈üle≈ü, risksiz antrenman</div>
            <div class="arena-mode-rewards">
              <span class="arena-reward">üíé 5-15</span>
              <span class="arena-reward">‚ö° 20 maliyet</span>
            </div>
          </div>
        </div>
        <div class="arena-mode ranked" onclick="game.startCombat('ranked')">
          <div class="arena-mode-icon">üèÜ</div>
          <div class="arena-mode-info">
            <div class="arena-mode-title">Dereceli Ma√ß</div>
            <div class="arena-mode-desc">Sƒ±ralama puanƒ± kazan, prestij artƒ±r</div>
            <div class="arena-mode-rewards">
              <span class="arena-reward">üíé 20-50</span>
              <span class="arena-reward">‚ö° 50 maliyet</span>
            </div>
          </div>
        </div>
        <div class="arena-mode tournament" onclick="game.startCombat('tournament')">
          <div class="arena-mode-icon">üëë</div>
          <div class="arena-mode-info">
            <div class="arena-mode-title">Turnuva</div>
            <div class="arena-mode-desc">3 rakibi yen, b√ºy√ºk √∂d√ºl kazan</div>
            <div class="arena-mode-rewards">
              <span class="arena-reward">üíé 100-500</span>
              <span class="arena-reward">‚ö° 100 maliyet</span>
            </div>
          </div>
        </div>
        <div class="arena-mode boss" onclick="game.startCombat('boss')">
          <div class="arena-mode-icon">üëπ</div>
          <div class="arena-mode-info">
            <div class="arena-mode-title">Patron Sava≈üƒ±</div>
            <div class="arena-mode-desc">Haftalƒ±k boss, efsanevi √∂d√ºller</div>
            <div class="arena-mode-rewards">
              <span class="arena-reward">üíé 200-1000</span>
              <span class="arena-reward">‚ö° 200 maliyet</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Select Rooster -->
      <div class="section-header" style="margin-top: 24px;">
        <h2 class="section-title">D√∂v√º≈ü√ß√º Se√ß</h2>
      </div>
      <div class="roosters-grid" id="arenaRoostersList">
        <!-- Roosters for selection -->
      </div>
    </main>

    <!-- Combat Screen -->
    <main class="screen" id="screenCombat">
      <div class="combat-container">
        <div class="combat-header">
          <div class="combat-round">Tur <span id="combatRound">1</span></div>
          <div class="combat-title">ARENA SAVA≈ûI</div>
        </div>

        <div class="combat-arena">
          <!-- Player Fighter -->
          <div class="fighter player" id="playerFighter">
            <div class="fighter-inner">
              <div class="fighter-avatar" id="playerFighterAvatar"></div>
              <div class="fighter-details">
                <div class="fighter-name" id="playerFighterName">Kƒ±zƒ±l ≈ûaban</div>
                <div class="fighter-hp-bar">
                  <div class="fighter-hp-fill" id="playerHpFill" style="width: 100%"></div>
                  <div class="fighter-hp-text"><span id="playerHpText">100</span>/100</div>
                </div>
                <div class="fighter-stats-row">
                  <div class="fighter-stat-mini">üí™ <span id="playerPowerStat">50</span></div>
                  <div class="fighter-stat-mini">‚ö° <span id="playerSpeedStat">45</span></div>
                </div>
              </div>
            </div>
          </div>

          <div class="combat-vs">‚öîÔ∏è</div>

          <!-- Opponent Fighter -->
          <div class="fighter opponent" id="opponentFighter">
            <div class="fighter-inner">
              <div class="fighter-avatar" id="opponentFighterAvatar"></div>
              <div class="fighter-details">
                <div class="fighter-name" id="opponentFighterName">Deli Hasan</div>
                <div class="fighter-hp-bar">
                  <div class="fighter-hp-fill" id="opponentHpFill" style="width: 100%"></div>
                  <div class="fighter-hp-text"><span id="opponentHpText">100</span>/100</div>
                </div>
                <div class="fighter-stats-row">
                  <div class="fighter-stat-mini">üí™ <span id="opponentPowerStat">48</span></div>
                  <div class="fighter-stat-mini">‚ö° <span id="opponentSpeedStat">52</span></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Rage Bar -->
        <div class="rage-bar-container">
          <div class="rage-bar-label">
            <span>üî• √ñfke</span>
            <span id="rageValue">0%</span>
          </div>
          <div class="rage-bar">
            <div class="rage-fill" id="rageFill" style="width: 0%"></div>
          </div>
        </div>

        <!-- Combat Log -->
        <div class="combat-log" id="combatLog">
          <div class="combat-log-entry">D√∂v√º≈ü ba≈ülƒ±yor! Horozlar kar≈üƒ± kar≈üƒ±ya!</div>
        </div>

        <!-- Combat Actions -->
        <div class="combat-actions">
          <button class="combat-action attack" onclick="game.combatAction('attack')">
            <span class="combat-action-icon">‚öîÔ∏è</span>
            Saldƒ±r
          </button>
          <button class="combat-action defend" onclick="game.combatAction('defend')">
            <span class="combat-action-icon">üõ°Ô∏è</span>
            Savun
          </button>
          <button class="combat-action special" id="specialBtn" onclick="game.combatAction('special')" disabled>
            <span class="combat-action-icon">üí•</span>
            √ñzel Hamle (100% √ñfke)
          </button>
        </div>
      </div>
    </main>

    <!-- City Screen -->
    <main class="screen" id="screenCity">
      <div class="section-header">
        <h2 class="section-title">ƒ∞stanbul Haritasƒ±</h2>
        <span class="section-action" id="conqueredCount">0/12 Fethedildi</span>
      </div>
      <div class="city-map" id="cityMap">
        <!-- Districts will be dynamically inserted -->
      </div>
    </main>

    <!-- Training Screen -->
    <main class="screen" id="screenTraining">
      <div class="section-header">
        <h2 class="section-title">D√∂v√º≈ü√ß√º Se√ß</h2>
      </div>
      <div class="roosters-grid" id="trainingRoostersList" style="margin-bottom: 20px;">
        <!-- Roosters for training -->
      </div>

      <div class="section-header">
        <h2 class="section-title">Antrenman Tipleri</h2>
      </div>
      <div class="training-options">
        <div class="training-option" onclick="game.trainRooster('power')">
          <div class="training-header">
            <div class="training-title">
              <div class="training-icon power">üí™</div>
              <span class="training-name">G√º√ß Antrenmanƒ±</span>
            </div>
            <span class="training-cost">‚ö° 30</span>
          </div>
          <div class="training-desc">Horozunun saldƒ±rƒ± g√ºc√ºn√º artƒ±r</div>
          <div class="training-effect">üìà G√º√ß +3-5 puan</div>
        </div>
        <div class="training-option" onclick="game.trainRooster('speed')">
          <div class="training-header">
            <div class="training-title">
              <div class="training-icon speed">‚ö°</div>
              <span class="training-name">Hƒ±z Antrenmanƒ±</span>
            </div>
            <span class="training-cost">‚ö° 30</span>
          </div>
          <div class="training-desc">Horozunun reflekslerini geli≈ütir</div>
          <div class="training-effect">üìà Hƒ±z +3-5 puan</div>
        </div>
        <div class="training-option" onclick="game.trainRooster('stamina')">
          <div class="training-header">
            <div class="training-title">
              <div class="training-icon stamina">‚ù§Ô∏è</div>
              <span class="training-name">Dayanƒ±klƒ±lƒ±k</span>
            </div>
            <span class="training-cost">‚ö° 30</span>
          </div>
          <div class="training-desc">Horozunun canƒ±nƒ± ve dayanƒ±klƒ±lƒ±ƒüƒ±nƒ± artƒ±r</div>
          <div class="training-effect">üìà Stamina +3-5 puan</div>
        </div>
        <div class="training-option" onclick="game.trainRooster('recovery')">
          <div class="training-header">
            <div class="training-title">
              <div class="training-icon recovery">üíä</div>
              <span class="training-name">Dinlenme</span>
            </div>
            <span class="training-cost">‚ö° 20</span>
          </div>
          <div class="training-desc">Horozunun yorgunluƒüunu azalt ve moral ver</div>
          <div class="training-effect">üìà Yorgunluk -30, Moral +20</div>
        </div>
      </div>
    </main>

    <!-- Market Screen -->
    <main class="screen" id="screenMarket">
      <div class="market-categories">
        <button class="market-category active" onclick="game.setMarketCategory('roosters')">üêì Horozlar</button>
        <button class="market-category" onclick="game.setMarketCategory('items')">üéí E≈üyalar</button>
        <button class="market-category" onclick="game.setMarketCategory('eggs')">ü•ö Yumurtalar</button>
      </div>

      <div class="market-items" id="marketItems">
        <!-- Market items will be dynamically inserted -->
      </div>
    </main>

    <!-- Bazaar Screen (Ads) -->
    <main class="screen" id="screenBazaar">
      <div class="bazaar-banner">
        <div class="bazaar-banner-icon">üì∫</div>
        <div class="bazaar-banner-title">Reklam Pazarƒ±</div>
        <div class="bazaar-banner-desc">Reklam izle, √∂d√ºl kazan, koruma aktifle!</div>
      </div>

      <div class="section-header">
        <h2 class="section-title">Bug√ºnk√º Fƒ±rsatlar</h2>
        <span class="section-action" id="dailyAdStatus">3/5 Kalan</span>
      </div>

      <div class="ad-options">
        <div class="ad-option" onclick="game.watchAd('crystal')">
          <div class="ad-option-header">
            <div class="ad-option-title">
              <div class="ad-option-icon crystal">üíé</div>
              <span class="ad-option-name">Kristal √ñd√ºl√º</span>
            </div>
            <span class="ad-option-reward">+15 üíé</span>
          </div>
          <div class="ad-option-desc">30 saniyelik reklam izle, kristal kazan</div>
        </div>

        <div class="ad-option" onclick="game.watchAd('energy')">
          <div class="ad-option-header">
            <div class="ad-option-title">
              <div class="ad-option-icon energy">‚ö°</div>
              <span class="ad-option-name">Enerji Dolumu</span>
            </div>
            <span class="ad-option-reward">+100 ‚ö°</span>
          </div>
          <div class="ad-option-desc">Enerjini yenile, sava≈ümaya devam et</div>
        </div>

        <div class="ad-option" onclick="game.watchAd('shield')">
          <div class="ad-option-header">
            <div class="ad-option-title">
              <div class="ad-option-icon shield">üõ°Ô∏è</div>
              <span class="ad-option-name">Koruma Kalkanƒ±</span>
            </div>
            <span class="ad-option-reward">1 Saat</span>
          </div>
          <div class="ad-option-desc">Ekonomi √ß√∂k√º≈ülerinden korun, kayƒ±plarƒ± √∂nle</div>
          <div class="ad-option-progress">
            <span class="ad-option-count" id="shieldAdCount">0/3 izlendi</span>
            <div class="ad-progress-bar">
              <div class="ad-progress-fill" id="shieldAdProgress" style="width: 0%"></div>
            </div>
          </div>
        </div>

        <div class="ad-option" onclick="game.watchAd('boost')">
          <div class="ad-option-header">
            <div class="ad-option-title">
              <div class="ad-option-icon boost">üöÄ</div>
              <span class="ad-option-name">XP Boost</span>
            </div>
            <span class="ad-option-reward">2x XP</span>
          </div>
          <div class="ad-option-desc">30 dakika boyunca √ßift deneyim puanƒ±</div>
        </div>
      </div>
    </main>

    <!-- Tasks Screen -->
    <main class="screen" id="screenTasks">
      <div class="tasks-tabs">
        <button class="tasks-tab active" onclick="game.setTaskTab('daily')">G√ºnl√ºk</button>
        <button class="tasks-tab" onclick="game.setTaskTab('weekly')">Haftalƒ±k</button>
        <button class="tasks-tab" onclick="game.setTaskTab('achievements')">Ba≈üarƒ±mlar</button>
      </div>

      <div class="task-list" id="taskList">
        <!-- Tasks will be dynamically inserted -->
      </div>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
      <button class="nav-item active" onclick="game.navigate('home')" data-screen="home">
        <span class="nav-icon">üè†</span>
        <span class="nav-label">Ana Sayfa</span>
      </button>
      <button class="nav-item" onclick="game.navigate('arena')" data-screen="arena">
        <span class="nav-icon">‚öîÔ∏è</span>
        <span class="nav-label">Arena</span>
      </button>
      <button class="nav-item" onclick="game.navigate('city')" data-screen="city">
        <span class="nav-icon">üèôÔ∏è</span>
        <span class="nav-label">≈ûehir</span>
      </button>
      <button class="nav-item" onclick="game.navigate('market')" data-screen="market">
        <span class="nav-icon">üõí</span>
        <span class="nav-label">Market</span>
      </button>
      <button class="nav-item" onclick="game.navigate('tasks')" data-screen="tasks">
        <span class="nav-icon">üìã</span>
        <span class="nav-label">G√∂revler</span>
        <span class="nav-badge" id="taskBadge">3</span>
      </button>
    </nav>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Modal Overlay -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title" id="modalTitle">Modal Ba≈ülƒ±k</h3>
        <button class="modal-close" onclick="game.closeModal()">‚úï</button>
      </div>
      <div class="modal-body" id="modalBody">
        <!-- Modal content -->
      </div>
      <div class="modal-actions" id="modalActions">
        <!-- Modal buttons -->
      </div>
    </div>
  </div>

  <!-- Ad Simulation -->
  <div class="ad-simulation" id="adSimulation">
    <div class="ad-content">
      <div class="ad-icon">üì∫</div>
      <div class="ad-title">Reklam ƒ∞zleniyor...</div>
      <div class="ad-timer" id="adTimer">5</div>
      <button class="ad-skip" id="adSkipBtn" onclick="game.skipAd()">√ñd√ºl√º Al</button>
    </div>
  </div>

  <!-- Result Overlay -->
  <div class="result-overlay" id="resultOverlay">
    <div class="result-icon" id="resultIcon">üèÜ</div>
    <div class="result-title" id="resultTitle">ZAFER!</div>
    <div class="result-subtitle" id="resultSubtitle">Rakibini yendin!</div>
    <div class="result-rewards">
      <div class="result-rewards-title">Kazanƒ±lan √ñd√ºller</div>
      <div class="result-rewards-list" id="resultRewardsList">
        <div class="result-reward-item">
          <div class="result-reward-icon">üíé</div>
          <div class="result-reward-value" id="rewardCrystals">+25</div>
        </div>
        <div class="result-reward-item">
          <div class="result-reward-icon">‚≠ê</div>
          <div class="result-reward-value" id="rewardXP">+50 XP</div>
        </div>
      </div>
    </div>
    <div class="result-actions">
      <button class="result-btn secondary" onclick="game.closeResult()">Ana Men√º</button>
      <button class="result-btn primary" onclick="game.playAgain()">Tekrar Oyna</button>
    </div>
  </div>

  <script>
    // ============================================
    // CONTENT GENERATOR
    // ============================================
    class ContentGenerator {
      static roosterNames = [
        'Kƒ±zƒ±l ≈ûaban', 'Deli Hasan', '√áƒ±lgƒ±n Murat', 'Yamuk Ali', 
        'K√∂pek ƒ∞smail', '≈ûeytan Erkan', 'Fƒ±rtƒ±na Kemal', 'Kabadayƒ± Rƒ±za',
        'Yƒ±ldƒ±rƒ±m Osman', 'Kaplan Cengiz', 'Bƒ±√ßkƒ±n Ferhat', 'Cellat Necmi',
        'Kasƒ±rga Selim', 'Alev Mehmet', 'G√∂lge Hakan', 'Demir Yumruk',
        'Kara Bela', '√áelik Pen√ße', 'Ate≈ü Topu', 'R√ºzgar Gibi'
      ];

      static breeds = [
        { name: 'Sokak Sava≈ü√ßƒ±sƒ±', tier: 'common', emoji: 'üêì' },
        { name: 'Anadolu Asili', tier: 'uncommon', emoji: 'üêî' },
        { name: 'ƒ∞stanbul Lordu', tier: 'rare', emoji: 'üëë' },
        { name: 'Cyber Horoz', tier: 'epic', emoji: 'ü§ñ' },
        { name: 'Efsane Anka', tier: 'legendary', emoji: 'üî•' }
      ];

      static elements = [
        { name: 'Ate≈ü', key: 'fire', emoji: 'üî•', color: '#ff6b00' },
        { name: 'Buz', key: 'ice', emoji: '‚ùÑÔ∏è', color: '#00f5ff' },
        { name: 'Toprak', key: 'earth', emoji: 'üåç', color: '#8B4513' },
        { name: 'Hava', key: 'air', emoji: 'üí®', color: '#87CEEB' },
        { name: 'G√∂lge', key: 'shadow', emoji: 'üåë', color: '#4B0082' }
      ];

      static traits = [
        { name: 'Saldƒ±rgan', effect: 'power', value: 10, desc: '+10% G√º√ß' },
        { name: '√áevik', effect: 'speed', value: 10, desc: '+10% Hƒ±z' },
        { name: 'Dayanƒ±klƒ±', effect: 'stamina', value: 10, desc: '+10% Dayanƒ±klƒ±lƒ±k' },
        { name: 'Vampir', effect: 'lifesteal', value: 5, desc: '5% Can √áalma' },
        { name: 'Kritik Ustasƒ±', effect: 'crit', value: 15, desc: '+15% Kritik ≈ûansƒ±' },
        { name: 'Tank', effect: 'defense', value: 10, desc: '+10% Savunma' },
        { name: 'Berserker', effect: 'rage', value: 20, desc: '+20% √ñfke Kazanƒ±mƒ±' },
        { name: '≈ûanslƒ±', effect: 'luck', value: 10, desc: '+10% ≈ûans' }
      ];

      static commentary = {
        hit: [
          'Gaga tam suratƒ±na!', 'Ciƒüerini s√∂kt√º!', 'Kanat ≈üamarƒ±!',
          'Bunu yedi i≈üte!', 'Acƒ± verici darbe!', 'T√ºyler havada u√ßu≈ütu!',
          'Sert bir vuru≈ü!', 'Aƒüzƒ±nƒ±n tadƒ±nƒ± aldƒ±!', 'Bu acƒ±mƒ±≈ütƒ±r!'
        ],
        critical: [
          'AMAN ALLAHIM!', 'RESMEN ƒ∞NFAZ!', 'BU NE G√ú√áT√úR?!',
          'KRƒ∞Tƒ∞K DARBE!', 'YIKILDI! YIKILDI!', 'EFSANE VURU≈û!',
          'ƒ∞NANILMAZ!', 'TARƒ∞HE GE√áTƒ∞!', 'ARENA SALLANDI!'
        ],
        miss: [
          'Hava yedi!', 'G√∂z√º g√∂rm√ºyor galiba!', 'Bo≈üa gitti!',
          'Iskaladƒ±!', 'R√ºzgarƒ± d√∂vd√º!', 'Bu ne bi√ßim saldƒ±rƒ±?!'
        ],
        defend: [
          'Savunmaya ge√ßti!', 'Kanatlarla korunuyor!', 'Defansif duru≈ü!',
          'Zeki hamle!', 'Kendini koruyor!', 'Stratejik savunma!'
        ],
        victory: [
          'ZAFER! Arena senindir!', 'Rakibini yerle bir ettin!',
          'Efsane galibiyetin kutlu olsun!', 'Kimse seni durduramaz!',
          'Arena\'nƒ±n yeni kralƒ±!', 'Bu galibiyetle tarih yazdƒ±n!'
        ],
        defeat: [
          'Maalesef yenildin...', 'Bu sefer olmadƒ± dostum...',
          'Rakip daha g√º√ßl√ºyd√º...', 'Pes etme, tekrar dene!',
          'Her usta bir zamanlar √ßƒ±raktƒ±...', 'Antrenmanla g√º√ßlen!'
        ]
      };

      static districts = [
        { id: 'kadikoy', name: 'Kadƒ±k√∂y', icon: 'üåä', difficulty: 1, reward: 50 },
        { id: 'besiktas', name: 'Be≈üikta≈ü', icon: '‚öì', difficulty: 2, reward: 75 },
        { id: 'uskudar', name: '√úsk√ºdar', icon: 'üïå', difficulty: 2, reward: 80 },
        { id: 'fatih', name: 'Fatih', icon: 'üèõÔ∏è', difficulty: 3, reward: 100 },
        { id: 'beyoglu', name: 'Beyoƒülu', icon: 'üé≠', difficulty: 3, reward: 110 },
        { id: 'sisli', name: '≈ûi≈üli', icon: 'üè¢', difficulty: 4, reward: 130 },
        { id: 'bakirkoy', name: 'Bakƒ±rk√∂y', icon: '‚úàÔ∏è', difficulty: 4, reward: 140 },
        { id: 'sariyer', name: 'Sarƒ±yer', icon: 'üå≤', difficulty: 5, reward: 160 },
        { id: 'maltepe', name: 'Maltepe', icon: 'üèñÔ∏è', difficulty: 3, reward: 100 },
        { id: 'pendik', name: 'Pendik', icon: 'üè≠', difficulty: 4, reward: 120 },
        { id: 'taksim', name: 'Taksim', icon: 'üóº', difficulty: 5, reward: 180 },
        { id: 'sultanahmet', name: 'Sultanahmet', icon: 'üëë', difficulty: 6, reward: 250 }
      ];

      static dailyTasks = [
        { id: 'fight3', title: '3 D√∂v√º≈ü Yap', desc: 'Arena\'da 3 d√∂v√º≈ü tamamla', target: 3, reward: { crystals: 20 } },
        { id: 'win1', title: 'Bir D√∂v√º≈ü Kazan', desc: 'Arena\'da 1 galibiyet al', target: 1, reward: { crystals: 15 } },
        { id: 'train2', title: 'Antrenman Yap', desc: 'Horozunu 2 kez antrenmana sok', target: 2, reward: { energy: 50 } },
        { id: 'watchAd', title: 'Reklam ƒ∞zle', desc: '1 reklam izle', target: 1, reward: { crystals: 10 } },
        { id: 'login', title: 'Giri≈ü Yap', desc: 'Oyuna giri≈ü yap', target: 1, reward: { crystals: 5 }, completed: true }
      ];

      static weeklyTasks = [
        { id: 'win10', title: '10 Galibiyet', desc: 'Bu hafta 10 d√∂v√º≈ü kazan', target: 10, reward: { crystals: 100 } },
        { id: 'conquer2', title: '2 Mahalle Fethet', desc: '≈ûehirde 2 mahalle fethet', target: 2, reward: { crystals: 150 } },
        { id: 'levelUp', title: 'Level Atla', desc: 'Horozunu level atla', target: 1, reward: { crystals: 75 } }
      ];

      static achievements = [
        { id: 'firstWin', title: 'ƒ∞lk Zafer', desc: 'ƒ∞lk galibiyetini al', reward: { crystals: 50 }, unlocked: false },
        { id: 'collector', title: 'Koleksiyoncu', desc: '5 horoz topla', reward: { crystals: 100 }, unlocked: false },
        { id: 'conqueror', title: 'Fatih', desc: 'T√ºm mahalleleri fethet', reward: { crystals: 500 }, unlocked: false }
      ];

      static marketRoosters = [
        { name: 'Sokak Horozu', breed: 0, price: 50, desc: 'Tecr√ºbeli sokak d√∂v√º≈ü√ß√ºs√º' },
        { name: 'Anadolu Asili', breed: 1, price: 150, desc: 'Soylu Anadolu kanƒ±' },
        { name: 'ƒ∞stanbul Lordu', breed: 2, price: 400, desc: '≈ûehrin efendisi' },
        { name: 'Cyber Horoz', breed: 3, price: 1000, desc: 'Teknoloji ile g√º√ßlendirilmi≈ü' }
      ];

      static marketItems = [
        { id: 'potion', name: 'Can ƒ∞ksiri', icon: 'üß™', price: 20, desc: '+50 Can', effect: 'heal' },
        { id: 'steroid', name: 'G√º√ß Serumu', icon: 'üíâ', price: 35, desc: '+10 G√º√ß (ge√ßici)', effect: 'power' },
        { id: 'coffee', name: 'T√ºrk Kahvesi', icon: '‚òï', price: 15, desc: '-20 Yorgunluk', effect: 'fatigue' },
        { id: 'amulet', name: '≈ûans Muskasƒ±', icon: 'üßø', price: 100, desc: '+5% Kritik', effect: 'crit' }
      ];

      static marketEggs = [
        { id: 'common', name: 'Normal Yumurta', icon: 'ü•ö', price: 30, desc: 'Sokak horozu ≈üansƒ± y√ºksek' },
        { id: 'rare', name: 'Altƒ±n Yumurta', icon: 'ü•á', price: 100, desc: 'Nadir horoz ≈üansƒ±' },
        { id: 'epic', name: 'Gizemli Yumurta', icon: 'üîÆ', price: 300, desc: 'Efsane horoz ≈üansƒ±!' }
      ];

      static getRandomName() {
        return this.roosterNames[Math.floor(Math.random() * this.roosterNames.length)];
      }

      static getRandomElement() {
        return this.elements[Math.floor(Math.random() * this.elements.length)];
      }

      static getRandomBreed(tier = 0) {
        return this.breeds[Math.min(tier, this.breeds.length - 1)];
      }

      static getRandomTraits(count = 1) {
        const shuffled = [...this.traits].sort(() => 0.5 - Math.random());
        return shuffled.slice(0, count);
      }

      static getCommentary(type) {
        const comments = this.commentary[type] || this.commentary.hit;
        return comments[Math.floor(Math.random() * comments.length)];
      }
    }

    // ============================================
    // AUDIO SERVICE
    // ============================================
    class AudioService {
      constructor() {
        this.ctx = null;
        this.enabled = true;
      }

      init() {
        try {
          this.ctx = new (window.AudioContext || window.webkitAudioContext)();
        } catch (e) {
          console.log('Audio not supported');
        }
      }

      resume() {
        if (this.ctx && this.ctx.state === 'suspended') {
          this.ctx.resume();
        }
      }

      playHit() {
        if (!this.ctx || !this.enabled) return;
        this.resume();
        
        const osc = this.ctx.createOscillator();
        const gain = this.ctx.createGain();
        
        osc.type = 'square';
        osc.frequency.setValueAtTime(200, this.ctx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(50, this.ctx.currentTime + 0.1);
        
        gain.gain.setValueAtTime(0.3, this.ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.1);
        
        osc.connect(gain).connect(this.ctx.destination);
        osc.start();
        osc.stop(this.ctx.currentTime + 0.1);
      }

      playCritical() {
        if (!this.ctx || !this.enabled) return;
        this.resume();
        
        const osc = this.ctx.createOscillator();
        const gain = this.ctx.createGain();
        
        osc.type = 'sawtooth';
        osc.frequency.setValueAtTime(400, this.ctx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(100, this.ctx.currentTime + 0.2);
        
        gain.gain.setValueAtTime(0.4, this.ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.2);
        
        osc.connect(gain).connect(this.ctx.destination);
        osc.start();
        osc.stop(this.ctx.currentTime + 0.2);
      }

      playCrystal() {
        if (!this.ctx || !this.enabled) return;
        this.resume();
        
        const osc = this.ctx.createOscillator();
        const gain = this.ctx.createGain();
        
        osc.type = 'sine';
        osc.frequency.setValueAtTime(800, this.ctx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(1200, this.ctx.currentTime + 0.1);
        osc.frequency.exponentialRampToValueAtTime(800, this.ctx.currentTime + 0.2);
        
        gain.gain.setValueAtTime(0.2, this.ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.3);
        
        osc.connect(gain).connect(this.ctx.destination);
        osc.start();
        osc.stop(this.ctx.currentTime + 0.3);
      }

      playVictory() {
        if (!this.ctx || !this.enabled) return;
        this.resume();
        
        const notes = [523, 659, 784, 1047];
        notes.forEach((freq, i) => {
          setTimeout(() => {
            const osc = this.ctx.createOscillator();
            const gain = this.ctx.createGain();
            
            osc.type = 'sine';
            osc.frequency.setValueAtTime(freq, this.ctx.currentTime);
            
            gain.gain.setValueAtTime(0.2, this.ctx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.3);
            
            osc.connect(gain).connect(this.ctx.destination);
            osc.start();
            osc.stop(this.ctx.currentTime + 0.3);
          }, i * 150);
        });
      }

      playDefeat() {
        if (!this.ctx || !this.enabled) return;
        this.resume();
        
        const osc = this.ctx.createOscillator();
        const gain = this.ctx.createGain();
        
        osc.type = 'sine';
        osc.frequency.setValueAtTime(400, this.ctx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(100, this.ctx.currentTime + 0.5);
        
        gain.gain.setValueAtTime(0.3, this.ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.5);
        
        osc.connect(gain).connect(this.ctx.destination);
        osc.start();
        osc.stop(this.ctx.currentTime + 0.5);
      }

      playClick() {
        if (!this.ctx || !this.enabled) return;
        this.resume();
        
        const osc = this.ctx.createOscillator();
        const gain = this.ctx.createGain();
        
        osc.type = 'sine';
        osc.frequency.setValueAtTime(600, this.ctx.currentTime);
        
        gain.gain.setValueAtTime(0.1, this.ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.05);
        
        osc.connect(gain).connect(this.ctx.destination);
        osc.start();
        osc.stop(this.ctx.currentTime + 0.05);
      }
    }

    // ============================================
    // GLOBAL ECONOMY
    // ============================================
    class GlobalEconomy {
      constructor() {
        this.dailyCrystalPool = 10000;
        this.claimedCrystals = 0;
        this.totalAdViewsToday = 0;
        this.stabilityIndex = 100;
        this.lastReset = new Date().toDateString();
        this.drainRate = 0;
      }

      load(data) {
        if (data) {
          this.dailyCrystalPool = data.dailyCrystalPool || 10000;
          this.claimedCrystals = data.claimedCrystals || 0;
          this.totalAdViewsToday = data.totalAdViewsToday || 0;
          this.stabilityIndex = data.stabilityIndex || 100;
          this.lastReset = data.lastReset || new Date().toDateString();
        }
        this.checkReset();
      }

      save() {
        return {
          dailyCrystalPool: this.dailyCrystalPool,
          claimedCrystals: this.claimedCrystals,
          totalAdViewsToday: this.totalAdViewsToday,
          stabilityIndex: this.stabilityIndex,
          lastReset: this.lastReset
        };
      }

      checkReset() {
        const today = new Date().toDateString();
        if (this.lastReset !== today) {
          this.dailyCrystalPool = 10000;
          this.claimedCrystals = 0;
          this.totalAdViewsToday = 0;
          this.stabilityIndex = 100;
          this.lastReset = today;
        }
      }

      calculateStability() {
        // Reklam izleme oranƒ±na g√∂re stabilite
        const adRatio = this.totalAdViewsToday / 50; // 50 reklam = tam stabilite
        const claimRatio = this.claimedCrystals / this.dailyCrystalPool;
        
        this.stabilityIndex = Math.max(0, Math.min(100, 
          100 - (claimRatio * 100) + (adRatio * 50)
        ));
        
        // Drain rate hesapla
        if (this.stabilityIndex < 40) {
          this.drainRate = Math.floor((40 - this.stabilityIndex) / 10);
        } else {
          this.drainRate = 0;
        }
        
        return this.stabilityIndex;
      }

      claimCrystals(amount) {
        const available = Math.min(amount, this.dailyCrystalPool - this.claimedCrystals);
        this.claimedCrystals += available;
        this.calculateStability();
        return available;
      }

      recordAdView() {
        this.totalAdViewsToday++;
        this.calculateStability();
      }

      getStatusText() {
        if (this.stabilityIndex >= 70) return 'Stabil';
        if (this.stabilityIndex >= 40) return 'Dalgalƒ±';
        return 'Kritik';
      }

      getStatusClass() {
        if (this.stabilityIndex >= 70) return '';
        if (this.stabilityIndex >= 40) return 'unstable';
        return 'critical';
      }

      getRemainingPool() {
        return this.dailyCrystalPool - this.claimedCrystals;
      }
    }

    // ============================================
    // ROOSTER CLASS
    // ============================================
    class Rooster {
      constructor(data = {}) {
        this.id = data.id || Date.now() + Math.random();
        this.name = data.name || ContentGenerator.getRandomName();
        this.breed = data.breed !== undefined ? data.breed : 0;
        this.element = data.element || ContentGenerator.getRandomElement();
        this.level = data.level || 1;
        this.xp = data.xp || 0;
        this.xpToNext = data.xpToNext || 100;
        
        this.stats = data.stats || {
          power: this.randomStat(30, 60),
          speed: this.randomStat(30, 60),
          stamina: this.randomStat(30, 60),
          health: 100,
          maxHealth: 100
        };
        
        this.fatigue = data.fatigue || 0;
        this.morale = data.morale || 100;
        this.traits = data.traits || ContentGenerator.getRandomTraits(1);
        this.visualSeed = data.visualSeed || Math.random();
        this.wins = data.wins || 0;
        this.losses = data.losses || 0;
      }

      randomStat(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      getBreedInfo() {
        return ContentGenerator.breeds[this.breed] || ContentGenerator.breeds[0];
      }

      getEffectivePower() {
        let power = this.stats.power;
        
        // Trait bonuslarƒ±
        this.traits.forEach(trait => {
          if (trait.effect === 'power') {
            power *= (1 + trait.value / 100);
          }
        });
        
        // Yorgunluk cezasƒ±
        power *= (1 - this.fatigue / 200);
        
        // Moral bonusu
        power *= (0.8 + this.morale / 500);
        
        return Math.floor(power);
      }

      getEffectiveSpeed() {
        let speed = this.stats.speed;
        
        this.traits.forEach(trait => {
          if (trait.effect === 'speed') {
            speed *= (1 + trait.value / 100);
          }
        });
        
        speed *= (1 - this.fatigue / 200);
        
        return Math.floor(speed);
      }

      getCritChance() {
        let crit = 10;
        
        this.traits.forEach(trait => {
          if (trait.effect === 'crit') {
            crit += trait.value;
          }
        });
        
        return crit;
      }

      addXP(amount) {
        this.xp += amount;
        
        while (this.xp >= this.xpToNext) {
          this.xp -= this.xpToNext;
          this.levelUp();
        }
      }

      levelUp() {
        this.level++;
        this.xpToNext = Math.floor(this.xpToNext * 1.5);
        
        // Stat artƒ±≈ülarƒ±
        this.stats.power += Math.floor(Math.random() * 3) + 2;
        this.stats.speed += Math.floor(Math.random() * 3) + 2;
        this.stats.stamina += Math.floor(Math.random() * 3) + 2;
        this.stats.maxHealth += 10;
        this.stats.health = this.stats.maxHealth;
        
        return true;
      }

      addFatigue(amount) {
        this.fatigue = Math.min(100, this.fatigue + amount);
      }

      rest(amount) {
        this.fatigue = Math.max(0, this.fatigue - amount);
      }

      getStatus() {
        if (this.stats.health <= 0) return { class: 'injured', text: 'Yaralƒ±' };
        if (this.fatigue >= 80) return { class: 'tired', text: 'Yorgun' };
        if (this.fatigue >= 50) return { class: 'tired', text: 'Dinlenmeli' };
        return { class: 'ready', text: 'Hazƒ±r' };
      }

      canFight() {
        return this.stats.health > 0 && this.fatigue < 80;
      }

      generateAvatar() {
        const element = this.element;
        const seed = this.visualSeed;
        const breed = this.getBreedInfo();
        
        // Seed'e g√∂re renkler
        const hue1 = Math.floor(seed * 360);
        const hue2 = (hue1 + 30) % 360;
        
        const bodyColor = `hsl(${hue1}, 70%, 45%)`;
        const accentColor = `hsl(${hue2}, 80%, 55%)`;
        const combColor = '#ff3333';
        
        return `
          <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="bodyGrad${this.id}" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:${bodyColor}"/>
                <stop offset="100%" style="stop-color:${accentColor}"/>
              </linearGradient>
              <filter id="glow${this.id}">
                <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
                <feMerge>
                  <feMergeNode in="coloredBlur"/>
                  <feMergeNode in="SourceGraphic"/>
                </feMerge>
              </filter>
            </defs>
            
            <!-- Body -->
            <ellipse cx="50" cy="60" rx="28" ry="25" fill="url(#bodyGrad${this.id})"/>
            
            <!-- Wing -->
            <ellipse cx="35" cy="58" rx="12" ry="18" fill="${accentColor}" opacity="0.8"/>
            
            <!-- Tail -->
            <path d="M75 55 Q95 40 85 25 Q80 35 75 45 Q90 35 82 20 Q75 30 72 40" 
                  fill="${accentColor}" filter="url(#glow${this.id})"/>
            
            <!-- Head -->
            <circle cx="50" cy="32" r="16" fill="url(#bodyGrad${this.id})"/>
            
            <!-- Comb -->
            <path d="M42 20 Q45 8 50 18 Q55 5 58 20" fill="${combColor}"/>
            
            <!-- Beak -->
            <polygon points="60,32 75,35 60,38" fill="#ffaa00"/>
            
            <!-- Eye -->
            <circle cx="55" cy="28" r="5" fill="white"/>
            <circle cx="56" cy="28" r="3" fill="black"/>
            <circle cx="57" cy="27" r="1" fill="white"/>
            
            <!-- Wattle -->
            <ellipse cx="55" cy="42" rx="5" ry="7" fill="${combColor}"/>
            
            <!-- Legs -->
            <line x1="42" y1="82" x2="38" y2="95" stroke="#ffaa00" stroke-width="3"/>
            <line x1="58" y1="82" x2="62" y2="95" stroke="#ffaa00" stroke-width="3"/>
            
            <!-- Element indicator -->
            <circle cx="85" cy="15" r="10" fill="${element.color}" filter="url(#glow${this.id})"/>
            <text x="85" y="19" text-anchor="middle" font-size="10">${element.emoji}</text>
            
            <!-- Level badge -->
            <circle cx="15" cy="85" r="12" fill="#1a1a25" stroke="${accentColor}" stroke-width="2"/>
            <text x="15" y="89" text-anchor="middle" font-size="10" fill="white" font-weight="bold">${this.level}</text>
          </svg>
        `;
      }

      toJSON() {
        return {
          id: this.id,
          name: this.name,
          breed: this.breed,
          element: this.element,
          level: this.level,
          xp: this.xp,
          xpToNext: this.xpToNext,
          stats: this.stats,
          fatigue: this.fatigue,
          morale: this.morale,
          traits: this.traits,
          visualSeed: this.visualSeed,
          wins: this.wins,
          losses: this.losses
        };
      }
    }

    // ============================================
    // PLAYER CLASS
    // ============================================
    class Player {
      constructor(data = {}) {
        this.name = data.name || 'Usta Mehmet';
        this.energy = data.energy !== undefined ? data.energy : 500;
        this.maxEnergy = data.maxEnergy || 500;
        this.crystals = data.crystals !== undefined ? data.crystals : 10;
        this.prestige = data.prestige || 0;
        this.rank = data.rank || '√áƒ±rak';
        
        this.adsWatchedToday = data.adsWatchedToday || 0;
        this.maxDailyAds = 5;
        this.shieldActive = data.shieldActive || false;
        this.shieldExpiry = data.shieldExpiry || null;
        this.shieldAdsWatched = data.shieldAdsWatched || 0;
        
        this.roosters = [];
        if (data.roosters && data.roosters.length > 0) {
          this.roosters = data.roosters.map(r => new Rooster(r));
        }
        
        this.inventory = data.inventory || [];
        this.conqueredDistricts = data.conqueredDistricts || [];
        
        this.stats = data.stats || {
          totalFights: 0,
          wins: 0,
          losses: 0,
          crystalsEarned: 0,
          adsWatched: 0
        };

        this.taskProgress = data.taskProgress || {
          fight3: 0,
          win1: 0,
          train2: 0,
          watchAd: 0,
          login: 1,
          win10: 0,
          conquer2: 0,
          levelUp: 0
        };

        this.lastLogin = data.lastLogin || new Date().toDateString();
        this.xpBoostExpiry = data.xpBoostExpiry || null;
      }

      checkDailyReset() {
        const today = new Date().toDateString();
        if (this.lastLogin !== today) {
          this.adsWatchedToday = 0;
          this.taskProgress.fight3 = 0;
          this.taskProgress.win1 = 0;
          this.taskProgress.train2 = 0;
          this.taskProgress.watchAd = 0;
          this.taskProgress.login = 1;
          this.lastLogin = today;
        }
      }

      addEnergy(amount) {
        this.energy = Math.min(this.maxEnergy, this.energy + amount);
      }

      useEnergy(amount) {
        if (this.energy >= amount) {
          this.energy -= amount;
          return true;
        }
        return false;
      }

      addCrystals(amount) {
        this.crystals += amount;
        this.stats.crystalsEarned += amount;
      }

      useCrystals(amount) {
        if (this.crystals >= amount) {
          this.crystals -= amount;
          return true;
        }
        return false;
      }

      getRankInfo() {
        const ranks = [
          { name: '√áƒ±rak', minPrestige: 0, emoji: 'ü•â' },
          { name: 'Kalfa', minPrestige: 100, emoji: 'ü•à' },
          { name: 'Usta', minPrestige: 500, emoji: 'ü•á' },
          { name: 'Kabadayƒ±', minPrestige: 1500, emoji: 'üí™' },
          { name: 'Efsane', minPrestige: 5000, emoji: 'üëë' },
          { name: 'ƒ∞mparator', minPrestige: 15000, emoji: 'üèÜ' }
        ];
        
        for (let i = ranks.length - 1; i >= 0; i--) {
          if (this.prestige >= ranks[i].minPrestige) {
            return ranks[i];
          }
        }
        return ranks[0];
      }

      updateRank() {
        this.rank = this.getRankInfo().name;
      }

      addPrestige(amount) {
        this.prestige += amount;
        this.updateRank();
      }

      checkShield() {
        if (this.shieldActive && this.shieldExpiry) {
          if (Date.now() > this.shieldExpiry) {
            this.shieldActive = false;
            this.shieldExpiry = null;
            return false;
          }
          return true;
        }
        return false;
      }

      activateShield(hours = 1) {
        this.shieldActive = true;
        this.shieldExpiry = Date.now() + (hours * 60 * 60 * 1000);
      }

      getShieldTimeRemaining() {
        if (!this.shieldActive || !this.shieldExpiry) return 0;
        return Math.max(0, this.shieldExpiry - Date.now());
      }

      hasXPBoost() {
        if (this.xpBoostExpiry && Date.now() < this.xpBoostExpiry) {
          return true;
        }
        this.xpBoostExpiry = null;
        return false;
      }

      activateXPBoost(minutes = 30) {
        this.xpBoostExpiry = Date.now() + (minutes * 60 * 1000);
      }

      getActiveRooster() {
        return this.roosters.find(r => r.canFight()) || this.roosters[0];
      }

      toJSON() {
        return {
          name: this.name,
          energy: this.energy,
          maxEnergy: this.maxEnergy,
          crystals: this.crystals,
          prestige: this.prestige,
          rank: this.rank,
          adsWatchedToday: this.adsWatchedToday,
          shieldActive: this.shieldActive,
          shieldExpiry: this.shieldExpiry,
          shieldAdsWatched: this.shieldAdsWatched,
          roosters: this.roosters.map(r => r.toJSON()),
          inventory: this.inventory,
          conqueredDistricts: this.conqueredDistricts,
          stats: this.stats,
          taskProgress: this.taskProgress,
          lastLogin: this.lastLogin,
          xpBoostExpiry: this.xpBoostExpiry
        };
      }
    }

    // ============================================
    // COMBAT ENGINE
    // ============================================
    class CombatEngine {
      constructor(playerRooster, opponentRooster, mode = 'street') {
        this.player = playerRooster;
        this.opponent = opponentRooster;
        this.mode = mode;
        
        this.turn = 1;
        this.maxTurns = 20;
        
        this.playerHP = playerRooster.stats.health;
        this.playerMaxHP = playerRooster.stats.maxHealth;
        this.opponentHP = opponentRooster.stats.health;
        this.opponentMaxHP = opponentRooster.stats.maxHealth;
        
        this.rageBar = 0;
        this.playerDefending = false;
        this.opponentDefending = false;
        
        this.log = [];
        this.isFinished = false;
        this.winner = null;
      }

      calculateDamage(attacker, defender, isDefending) {
        const baseDamage = attacker.getEffectivePower();
        const speed = attacker.getEffectiveSpeed();
        
        // Temel hasar
        let damage = Math.floor(baseDamage * (0.8 + Math.random() * 0.4));
        
        // Savunma azaltmasƒ±
        if (isDefending) {
          damage = Math.floor(damage * 0.4);
        }
        
        // Kritik vuru≈ü
        const critChance = attacker.getCritChance();
        const isCritical = Math.random() * 100 < critChance;
        if (isCritical) {
          damage = Math.floor(damage * 1.8);
        }
        
        // Ka√ßƒ±rma ≈üansƒ±
        const dodgeChance = defender.getEffectiveSpeed() / 3;
        const isDodged = Math.random() * 100 < dodgeChance;
        if (isDodged) {
          damage = 0;
        }
        
        // Element avantajƒ±
        const elementBonus = this.checkElementAdvantage(attacker.element, defender.element);
        damage = Math.floor(damage * elementBonus);
        
        return {
          damage,
          isCritical,
          isDodged,
          elementBonus
        };
      }

      checkElementAdvantage(attacker, defender) {
        const advantages = {
          fire: 'air',
          ice: 'fire',
          earth: 'ice',
          air: 'earth',
          shadow: 'air'
        };
        
        if (advantages[attacker.key] === defender.key) {
          return 1.3; // %30 bonus
        }
        if (advantages[defender.key] === attacker.key) {
          return 0.7; // %30 dezavantaj
        }
        return 1;
      }

      playerAttack() {
        const result = this.calculateDamage(this.player, this.opponent, this.opponentDefending);
        
        if (result.isDodged) {
          this.addLog(ContentGenerator.getCommentary('miss'), 'miss');
        } else if (result.isCritical) {
          this.addLog(`KRƒ∞Tƒ∞K! ${result.damage} hasar! ${ContentGenerator.getCommentary('critical')}`, 'critical');
          this.rageBar = Math.min(100, this.rageBar + 25);
        } else {
          this.addLog(`${this.player.name} saldƒ±rdƒ±: ${result.damage} hasar. ${ContentGenerator.getCommentary('hit')}`, 'hit');
          this.rageBar = Math.min(100, this.rageBar + 10);
        }
        
        this.opponentHP = Math.max(0, this.opponentHP - result.damage);
        this.opponentDefending = false;
        
        return result;
      }

      playerDefend() {
        this.playerDefending = true;
        this.rageBar = Math.min(100, this.rageBar + 15);
        this.addLog(`${this.player.name} savunmaya ge√ßti! ${ContentGenerator.getCommentary('defend')}`, 'defend');
      }

      playerSpecial() {
        if (this.rageBar < 100) return false;
        
        const baseDamage = this.player.getEffectivePower() * 2.5;
        const damage = Math.floor(baseDamage * (0.9 + Math.random() * 0.2));
        
        this.opponentHP = Math.max(0, this.opponentHP - damage);
        this.rageBar = 0;
        
        this.addLog(`üí• √ñZEL HAMLE! ${damage} MUAZZAM HASAR! ${ContentGenerator.getCommentary('critical')}`, 'critical');
        
        return { damage, isCritical: true };
      }

      opponentTurn() {
        // Basit AI
        const shouldDefend = Math.random() < 0.25;
        
        if (shouldDefend) {
          this.opponentDefending = true;
          this.addLog(`${this.opponent.name} savunmaya ge√ßti!`, 'defend');
        } else {
          const result = this.calculateDamage(this.opponent, this.player, this.playerDefending);
          
          if (result.isDodged) {
            this.addLog(`${this.player.name} saldƒ±rƒ±dan ka√ßtƒ±!`, 'miss');
          } else if (result.isCritical) {
            this.addLog(`${this.opponent.name} KRƒ∞Tƒ∞K VURDU: ${result.damage} hasar!`, 'critical');
          } else {
            this.addLog(`${this.opponent.name} saldƒ±rdƒ±: ${result.damage} hasar.`, 'hit');
          }
          
          this.playerHP = Math.max(0, this.playerHP - result.damage);
          this.playerDefending = false;
        }
      }

      processTurn(action) {
        // Oyuncu aksiyonu
        if (action === 'attack') {
          this.playerAttack();
        } else if (action === 'defend') {
          this.playerDefend();
        } else if (action === 'special') {
          this.playerSpecial();
        }
        
        // Zafer kontrol√º
        if (this.checkVictory()) return;
        
        // Rakip turu
        this.opponentTurn();
        
        // Zafer kontrol√º
        if (this.checkVictory()) return;
        
        this.turn++;
        
        // Maksimum tur kontrol√º
        if (this.turn > this.maxTurns) {
          this.isFinished = true;
          this.winner = this.playerHP > this.opponentHP ? 'player' : 'opponent';
        }
      }

      checkVictory() {
        if (this.opponentHP <= 0) {
          this.isFinished = true;
          this.winner = 'player';
          this.addLog(ContentGenerator.getCommentary('victory'), 'victory');
          return true;
        }
        if (this.playerHP <= 0) {
          this.isFinished = true;
          this.winner = 'opponent';
          this.addLog(ContentGenerator.getCommentary('defeat'), 'defeat');
          return true;
        }
        return false;
      }

      addLog(message, type = 'normal') {
        this.log.push({ message, type, turn: this.turn });
      }

      getRewards() {
        if (this.winner !== 'player') {
          return { crystals: 0, xp: 10, prestige: 0 };
        }
        
        const modeMultipliers = {
          street: { crystals: [5, 15], xp: [20, 40], prestige: [5, 10] },
          ranked: { crystals: [20, 50], xp: [40, 80], prestige: [15, 30] },
          tournament: { crystals: [100, 300], xp: [100, 200], prestige: [50, 100] },
          boss: { crystals: [200, 500], xp: [200, 400], prestige: [100, 200] }
        };
        
        const mult = modeMultipliers[this.mode] || modeMultipliers.street;
        
        return {
          crystals: Math.floor(Math.random() * (mult.crystals[1] - mult.crystals[0])) + mult.crystals[0],
          xp: Math.floor(Math.random() * (mult.xp[1] - mult.xp[0])) + mult.xp[0],
          prestige: Math.floor(Math.random() * (mult.prestige[1] - mult.prestige[0])) + mult.prestige[0]
        };
      }
    }

    // ============================================
    // SENSOR MANAGER
    // ============================================
    class SensorManager {
      constructor(gameManager) {
        this.game = gameManager;
        this.shakeThreshold = 25;
        this.lastShake = 0;
        this.micEnabled = false;
        
        this.setupAccelerometer();
      }

      setupAccelerometer() {
        if ('DeviceMotionEvent' in window) {
          // iOS 13+ i√ßin izin gerekiyor
          if (typeof DeviceMotionEvent.requestPermission === 'function') {
            // ƒ∞zin butonuyla tetiklenmeli
          } else {
            window.addEventListener('devicemotion', (e) => this.handleMotion(e));
          }
        }
      }

      handleMotion(e) {
        if (!this.game.combat || this.game.combat.isFinished) return;
        
        const acc = e.accelerationIncludingGravity;
        if (!acc) return;
        
        const total = Math.abs(acc.x || 0) + Math.abs(acc.y || 0) + Math.abs(acc.z || 0);
        const now = Date.now();
        
        if (total > this.shakeThreshold && now - this.lastShake > 500) {
          this.lastShake = now;
          this.game.combat.rageBar = Math.min(100, this.game.combat.rageBar + 15);
          this.game.showToast('üì≥ Salladƒ±n! √ñfke +15!', 'success');
          this.game.updateCombatUI();
        }
      }

      async requestMotionPermission() {
        if (typeof DeviceMotionEvent.requestPermission === 'function') {
          try {
            const permission = await DeviceMotionEvent.requestPermission();
            if (permission === 'granted') {
              window.addEventListener('devicemotion', (e) => this.handleMotion(e));
              return true;
            }
          } catch (e) {
            console.log('Motion permission denied');
          }
        }
        return false;
      }
    }

    // ============================================
    // GAME MANAGER
    // ============================================
    class GameManager {
      constructor() {
        this.globalEconomy = new GlobalEconomy();
        this.player = null;
        this.audio = new AudioService();
        this.sensors = null;
        
        this.currentScreen = 'home';
        this.combat = null;
        this.combatMode = 'street';
        this.selectedRooster = null;
        this.selectedTrainingRooster = null;
        
        this.marketCategory = 'roosters';
        this.taskTab = 'daily';
        
        this.adCallback = null;
        this.adType = null;
        
        this.init();
      }

      init() {
        this.loadGame();
        this.audio.init();
        this.sensors = new SensorManager(this);
        
        this.setupEventListeners();
        this.startGameLoop();
        
        this.render();
        
        // Yeni oyuncu i√ßin ba≈ülangƒ±√ß horozu
        if (this.player.roosters.length === 0) {
          this.giveStarterRooster();
        }
      }

      loadGame() {
        try {
          const savedData = localStorage.getItem('horozImparatorlugu');
          if (savedData) {
            const data = JSON.parse(savedData);
            this.player = new Player(data.player);
            this.globalEconomy.load(data.economy);
          } else {
            this.player = new Player();
          }
          
          this.player.checkDailyReset();
          this.globalEconomy.checkReset();
        } catch (e) {
          console.error('Load error:', e);
          this.player = new Player();
        }
      }

      saveGame() {
        try {
          const data = {
            player: this.player.toJSON(),
            economy: this.globalEconomy.save(),
            savedAt: Date.now()
          };
          localStorage.setItem('horozImparatorlugu', JSON.stringify(data));
        } catch (e) {
          console.error('Save error:', e);
        }
      }

      giveStarterRooster() {
        const starter = new Rooster({
          name: 'Kƒ±zƒ±l ≈ûaban',
          breed: 0,
          level: 1
        });
        this.player.roosters.push(starter);
        this.showToast('üêì ƒ∞lk horozun: ' + starter.name + '!', 'success');
        this.saveGame();
      }

      setupEventListeners() {
        // Touch ses i√ßin
        document.addEventListener('touchstart', () => {
          this.audio.resume();
        }, { once: true });
        
        document.addEventListener('click', () => {
          this.audio.resume();
        }, { once: true });
        
        // Visibility change - kaydet
        document.addEventListener('visibilitychange', () => {
          if (document.hidden) {
            this.saveGame();
          }
        });
      }

      startGameLoop() {
        // 1 saniyede bir g√ºncelleme
        setInterval(() => {
          this.update();
        }, 1000);
        
        // 5 saniyede kayƒ±t
        setInterval(() => {
          this.saveGame();
        }, 5000);
        
        // Enerji yenileme (5 dakikada 1)
        setInterval(() => {
          if (this.player.energy < this.player.maxEnergy) {
            this.player.addEnergy(1);
            this.updateHeader();
          }
        }, 5000); // Demo i√ßin hƒ±zlƒ±
      }

      update() {
        // Shield kontrol√º
        if (this.player.shieldActive) {
          if (!this.player.checkShield()) {
            this.showToast('üõ°Ô∏è Koruma s√ºresi doldu!', 'warning');
          }
        }
        
        // Yorgunluk azaltma
        this.player.roosters.forEach(r => {
          if (r.fatigue > 0) {
            r.rest(0.5);
          }
        });
        
        // Ekonomi stabilite kontrol√º
        this.globalEconomy.calculateStability();
        
        // Drain (korumasƒ±z oyunculara)
        if (this.globalEconomy.drainRate > 0 && !this.player.shieldActive) {
          // Her dakika kontrol
        }
        
        // UI g√ºncelle
        if (this.currentScreen === 'home') {
          this.updateEconomyUI();
          this.updateShieldUI();
        }
        
        this.updateHeader();
      }

      // ========== NAVIGATION ==========
      navigate(screen) {
        this.audio.playClick();
        
        // Combat ekranƒ±ndan √ßƒ±kƒ±≈ü kontrol√º
        if (this.currentScreen === 'combat' && screen !== 'combat') {
          if (this.combat && !this.combat.isFinished) {
            this.showToast('‚ö†Ô∏è √ñnce d√∂v√º≈ü√º bitir!', 'warning');
            return;
          }
        }
        
        // √ñnceki ekranƒ± gizle
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        
        // Yeni ekranƒ± g√∂ster
        const screenEl = document.getElementById('screen' + screen.charAt(0).toUpperCase() + screen.slice(1));
        if (screenEl) {
          screenEl.classList.add('active');
        }
        
        // Nav g√ºncelle
        document.querySelectorAll('.nav-item').forEach(item => {
          item.classList.remove('active');
          if (item.dataset.screen === screen) {
            item.classList.add('active');
          }
        });
        
        // Header g√∂ster/gizle
        const header = document.getElementById('mainHeader');
        const bottomNav = document.querySelector('.bottom-nav');
        
        if (screen === 'combat') {
          header.style.display = 'none';
          bottomNav.style.display = 'none';
        } else {
          header.style.display = 'flex';
          bottomNav.style.display = 'flex';
        }
        
        this.currentScreen = screen;
        this.renderScreen(screen);
      }

      renderScreen(screen) {
        switch (screen) {
          case 'home':
            this.renderHome();
            break;
          case 'arena':
            this.renderArena();
            break;
          case 'city':
            this.renderCity();
            break;
          case 'training':
            this.renderTraining();
            break;
          case 'market':
            this.renderMarket();
            break;
          case 'bazaar':
            this.renderBazaar();
            break;
          case 'tasks':
            this.renderTasks();
            break;
        }
      }

      render() {
        this.updateHeader();
        this.renderScreen(this.currentScreen);
      }

      // ========== HEADER ==========
      updateHeader() {
        document.getElementById('playerName').textContent = this.player.name;
        document.getElementById('rankText').textContent = this.player.rank;
        document.getElementById('energyValue').textContent = this.player.energy;
        document.getElementById('crystalValue').textContent = this.player.crystals;
      }

      // ========== HOME SCREEN ==========
      renderHome() {
        this.updateEconomyUI();
        this.updateShieldUI();
        this.renderRoostersList('roostersList');
        
        document.getElementById('adCount').textContent = this.player.maxDailyAds - this.player.adsWatchedToday;
      }

      updateEconomyUI() {
        const stability = this.globalEconomy.stabilityIndex;
        const remaining = this.globalEconomy.getRemainingPool();
        
        document.getElementById('dailyPoolValue').textContent = this.formatNumber(this.globalEconomy.dailyCrystalPool);
        document.getElementById('claimedValue').textContent = this.formatNumber(this.globalEconomy.claimedCrystals);
        document.getElementById('stabilityValue').textContent = Math.floor(stability) + '%';
        document.getElementById('stabilityText').textContent = this.globalEconomy.getStatusText();
        
        const statusEl = document.getElementById('economyStatus');
        statusEl.className = 'economy-status ' + this.globalEconomy.getStatusClass();
        
        const progressFill = document.getElementById('economyProgressFill');
        progressFill.style.width = stability + '%';
        progressFill.className = 'progress-fill';
        if (stability < 40) progressFill.classList.add('danger');
        else if (stability < 70) progressFill.classList.add('warning');
      }

      updateShieldUI() {
        const banner = document.getElementById('shieldBanner');
        const title = document.getElementById('shieldTitle');
        const desc = document.getElementById('shieldDesc');
        
        if (this.player.checkShield()) {
          banner.classList.remove('shield-inactive');
          title.textContent = 'Koruma Aktif';
          const remaining = this.player.getShieldTimeRemaining();
          const minutes = Math.floor(remaining / 60000);
          desc.textContent = `${minutes} dakika kaldƒ±`;
        } else {
          banner.classList.add('shield-inactive');
          title.textContent = 'Koruma Kapalƒ±';
          desc.textContent = 'Reklam izleyerek koruma aktifle';
        }
      }

      // ========== ROOSTERS LIST ==========
      renderRoostersList(containerId, selectable = false, onSelect = null) {
        const container = document.getElementById(containerId);
        if (!container) return;
        
        if (this.player.roosters.length === 0) {
          container.innerHTML = `
            <div class="card" style="padding: 30px; text-align: center;">
              <div style="font-size: 48px; margin-bottom: 16px;">ü•ö</div>
              <div style="font-size: 16px; color: var(--text-secondary);">Hen√ºz horozun yok</div>
              <button class="modal-btn primary" style="margin-top: 16px;" onclick="game.navigate('market')">
                Market'e Git
              </button>
            </div>
          `;
          return;
        }
        
        container.innerHTML = this.player.roosters.map((rooster, index) => {
          const status = rooster.getStatus();
          const breed = rooster.getBreedInfo();
          const isSelected = this.selectedRooster === rooster;
          
          return `
            <div class="rooster-card element-${rooster.element.key} ${isSelected ? 'selected' : ''}" 
                 onclick="${selectable ? `game.selectRooster(${index})` : `game.showRoosterDetail(${index})`}"
                 style="${isSelected ? 'border-color: var(--neon-cyan); box-shadow: var(--shadow-neon);' : ''}">
              <div class="rooster-avatar">${rooster.generateAvatar()}</div>
              <div class="rooster-info">
                <div class="rooster-header">
                  <span class="rooster-name">${rooster.name}</span>
                  <span class="rooster-level">Lv.${rooster.level}</span>
                </div>
                <div class="rooster-breed">${breed.emoji} ${breed.name} ‚Ä¢ <span>${rooster.element.emoji} ${rooster.element.name}</span></div>
                <div class="rooster-stats">
                  <div class="rooster-stat">
                    <div class="rooster-stat-value">${rooster.getEffectivePower()}</div>
                    <div class="rooster-stat-label">G√º√ß</div>
                  </div>
                  <div class="rooster-stat">
                    <div class="rooster-stat-value">${rooster.getEffectiveSpeed()}</div>
                    <div class="rooster-stat-label">Hƒ±z</div>
                  </div>
                  <div class="rooster-stat">
                    <div class="rooster-stat-value">${rooster.stats.stamina}</div>
                    <div class="rooster-stat-label">Stam</div>
                  </div>
                </div>
                <div class="rooster-status">
                  <span class="status-badge ${status.class}">${status.text}</span>
                  ${rooster.fatigue > 0 ? `<span class="status-badge tired">üòì ${Math.floor(rooster.fatigue)}%</span>` : ''}
                </div>
              </div>
            </div>
          `;
        }).join('');
      }

      selectRooster(index) {
        this.audio.playClick();
        this.selectedRooster = this.player.roosters[index];
        this.renderRoostersList('arenaRoostersList', true);
      }

      showRoosterDetail(index) {
        const rooster = this.player.roosters[index];
        this.showModal(rooster.name, `
          <div style="text-align: center; margin-bottom: 20px;">
            <div style="width: 120px; height: 120px; margin: 0 auto;">
              ${rooster.generateAvatar()}
            </div>
          </div>
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 16px;">
            <div class="card" style="padding: 12px; text-align: center;">
              <div style="font-size: 24px; font-weight: 700; color: var(--neon-pink);">${rooster.getEffectivePower()}</div>
              <div style="font-size: 11px; color: var(--text-muted);">G√º√ß</div>
            </div>
            <div class="card" style="padding: 12px; text-align: center;">
              <div style="font-size: 24px; font-weight: 700; color: var(--neon-cyan);">${rooster.getEffectiveSpeed()}</div>
              <div style="font-size: 11px; color: var(--text-muted);">Hƒ±z</div>
            </div>
            <div class="card" style="padding: 12px; text-align: center;">
              <div style="font-size: 24px; font-weight: 700; color: var(--neon-green);">${rooster.stats.stamina}</div>
              <div style="font-size: 11px; color: var(--text-muted);">Dayanƒ±klƒ±lƒ±k</div>
            </div>
            <div class="card" style="padding: 12px; text-align: center;">
              <div style="font-size: 24px; font-weight: 700; color: var(--neon-yellow);">${rooster.stats.maxHealth}</div>
              <div style="font-size: 11px; color: var(--text-muted);">Max Can</div>
            </div>
          </div>
          <div style="margin-bottom: 16px;">
            <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: 8px;">√ñzellikler:</div>
            ${rooster.traits.map(t => `
              <span style="display: inline-block; background: var(--bg-dark); padding: 6px 12px; border-radius: 12px; margin: 4px; font-size: 12px;">
                ${t.name}: ${t.desc}
              </span>
            `).join('')}
          </div>
          <div style="display: flex; gap: 12px; font-size: 13px; color: var(--text-muted);">
            <span>üèÜ ${rooster.wins} Galibiyet</span>
            <span>üíî ${rooster.losses} Yenilgi</span>
          </div>
        `, [
          { text: 'Kapat', class: 'secondary', action: 'game.closeModal()' }
        ]);
      }

      // ========== ARENA ==========
      renderArena() {
        this.selectedRooster = this.player.getActiveRooster();
        this.renderRoostersList('arenaRoostersList', true);
      }

      startCombat(mode) {
        this.audio.playClick();
        
        if (!this.selectedRooster) {
          this.showToast('‚ö†Ô∏è √ñnce bir horoz se√ß!', 'warning');
          return;
        }
        
        if (!this.selectedRooster.canFight()) {
          this.showToast('‚ö†Ô∏è Bu horoz sava≈üamaz!', 'warning');
          return;
        }
        
        const energyCosts = {
          street: 20,
          ranked: 50,
          tournament: 100,
          boss: 200
        };
        
        const cost = energyCosts[mode] || 20;
        
        if (!this.player.useEnergy(cost)) {
          this.showToast('‚ö†Ô∏è Yeterli enerji yok!', 'warning');
          return;
        }
        
        this.combatMode = mode;
        
        // Rakip olu≈ütur
        const opponentLevel = Math.max(1, this.selectedRooster.level + Math.floor(Math.random() * 3) - 1);
        const opponent = new Rooster({
          name: ContentGenerator.getRandomName(),
          breed: Math.min(this.selectedRooster.breed + 1, 4),
          level: opponentLevel
        });
        
        // Boss modu i√ßin g√º√ßl√º rakip
        if (mode === 'boss') {
          opponent.stats.power *= 1.5;
          opponent.stats.speed *= 1.3;
          opponent.stats.maxHealth *= 2;
          opponent.stats.health = opponent.stats.maxHealth;
        }
        
        this.combat = new CombatEngine(this.selectedRooster, opponent, mode);
        
        this.navigate('combat');
        this.renderCombat();
        
        // Task progress
        this.player.taskProgress.fight3++;
        this.player.stats.totalFights++;
      }

      renderCombat() {
        const combat = this.combat;
        
        // Oyuncu
        document.getElementById('playerFighterName').textContent = combat.player.name;
        document.getElementById('playerFighterAvatar').innerHTML = combat.player.generateAvatar();
        document.getElementById('playerPowerStat').textContent = combat.player.getEffectivePower();
        document.getElementById('playerSpeedStat').textContent = combat.player.getEffectiveSpeed();
        
        // Rakip
        document.getElementById('opponentFighterName').textContent = combat.opponent.name;
        document.getElementById('opponentFighterAvatar').innerHTML = combat.opponent.generateAvatar();
        document.getElementById('opponentPowerStat').textContent = combat.opponent.getEffectivePower();
        document.getElementById('opponentSpeedStat').textContent = combat.opponent.getEffectiveSpeed();
        
        this.updateCombatUI();
      }

      updateCombatUI() {
        if (!this.combat) return;
        
        const combat = this.combat;
        
        // Tur
        document.getElementById('combatRound').textContent = combat.turn;
        
        // HP bars
        const playerHpPercent = (combat.playerHP / combat.playerMaxHP) * 100;
        const opponentHpPercent = (combat.opponentHP / combat.opponentMaxHP) * 100;
        
        const playerHpFill = document.getElementById('playerHpFill');
        playerHpFill.style.width = playerHpPercent + '%';
        playerHpFill.className = 'fighter-hp-fill';
        if (playerHpPercent < 25) playerHpFill.classList.add('low');
        else if (playerHpPercent < 50) playerHpFill.classList.add('medium');
        
        const opponentHpFill = document.getElementById('opponentHpFill');
        opponentHpFill.style.width = opponentHpPercent + '%';
        opponentHpFill.className = 'fighter-hp-fill';
        if (opponentHpPercent < 25) opponentHpFill.classList.add('low');
        else if (opponentHpPercent < 50) opponentHpFill.classList.add('medium');
        
        document.getElementById('playerHpText').textContent = Math.max(0, Math.floor(combat.playerHP));
        document.getElementById('opponentHpText').textContent = Math.max(0, Math.floor(combat.opponentHP));
        
        // Rage bar
        document.getElementById('rageValue').textContent = combat.rageBar + '%';
        document.getElementById('rageFill').style.width = combat.rageBar + '%';
        
        // Special button
        document.getElementById('specialBtn').disabled = combat.rageBar < 100;
        
        // Combat log
        this.renderCombatLog();
      }

      renderCombatLog() {
        const logContainer = document.getElementById('combatLog');
        const recentLogs = this.combat.log.slice(-5);
        
        logContainer.innerHTML = recentLogs.map(entry => `
          <div class="combat-log-entry ${entry.type}">${entry.message}</div>
        `).join('');
        
        logContainer.scrollTop = logContainer.scrollHeight;
      }

      combatAction(action) {
        if (!this.combat || this.combat.isFinished) return;
        
        // Ses
        if (action === 'attack') {
          this.audio.playHit();
        } else if (action === 'special') {
          this.audio.playCritical();
        }
        
        // Aksiyon i≈üle
        this.combat.processTurn(action);
        
        // UI g√ºncelle
        this.updateCombatUI();
        
        // Animasyonlar
        if (action === 'attack' || action === 'special') {
          document.getElementById('opponentFighter').classList.add('hit-effect');
          setTimeout(() => {
            document.getElementById('opponentFighter').classList.remove('hit-effect');
          }, 300);
        }
        
        // D√∂v√º≈ü bitti mi?
        if (this.combat.isFinished) {
          setTimeout(() => {
            this.endCombat();
          }, 1000);
        }
      }

      endCombat() {
        const combat = this.combat;
        const rewards = combat.getRewards();
        const victory = combat.winner === 'player';
        
        if (victory) {
          this.audio.playVictory();
          
          // √ñd√ºlleri ver
          const claimedCrystals = this.globalEconomy.claimCrystals(rewards.crystals);
          this.player.addCrystals(claimedCrystals);
          this.player.addPrestige(rewards.prestige);
          
          // XP
          let xpGain = rewards.xp;
          if (this.player.hasXPBoost()) {
            xpGain *= 2;
          }
          this.selectedRooster.addXP(xpGain);
          this.selectedRooster.wins++;
          
          // Stats
          this.player.stats.wins++;
          this.player.taskProgress.win1++;
          this.player.taskProgress.win10++;
          
          // Result g√∂ster
          document.getElementById('resultIcon').textContent = 'üèÜ';
          document.getElementById('resultTitle').textContent = 'ZAFER!';
          document.getElementById('resultTitle').className = 'result-title victory';
          document.getElementById('resultSubtitle').textContent = ContentGenerator.getCommentary('victory');
          document.getElementById('rewardCrystals').textContent = '+' + claimedCrystals;
          document.getElementById('rewardXP').textContent = '+' + xpGain + ' XP';
        } else {
          this.audio.playDefeat();
          
          this.selectedRooster.losses++;
          this.player.stats.losses++;
          
          document.getElementById('resultIcon').textContent = 'üíî';
          document.getElementById('resultTitle').textContent = 'YENƒ∞LGƒ∞';
          document.getElementById('resultTitle').className = 'result-title defeat';
          document.getElementById('resultSubtitle').textContent = ContentGenerator.getCommentary('defeat');
          document.getElementById('rewardCrystals').textContent = '+0';
          document.getElementById('rewardXP').textContent = '+10 XP';
          
          this.selectedRooster.addXP(10);
        }
        
        // Yorgunluk ekle
        this.selectedRooster.addFatigue(15);
        
        // Result overlay g√∂ster
        document.getElementById('resultOverlay').classList.add('active');
        
        this.saveGame();
      }

      closeResult() {
        document.getElementById('resultOverlay').classList.remove('active');
        this.combat = null;
        this.navigate('home');
      }

      playAgain() {
        document.getElementById('resultOverlay').classList.remove('active');
        this.combat = null;
        this.navigate('arena');
      }

      // ========== CITY ==========
      renderCity() {
        const container = document.getElementById('cityMap');
        const districts = ContentGenerator.districts;
        
        const conqueredCount = this.player.conqueredDistricts.length;
        document.getElementById('conqueredCount').textContent = `${conqueredCount}/${districts.length} Fethedildi`;
        
        container.innerHTML = districts.map(district => {
          const isConquered = this.player.conqueredDistricts.includes(district.id);
          
          return `
            <div class="district ${isConquered ? 'conquered' : ''}" onclick="game.attackDistrict('${district.id}')">
              <div class="district-icon">${district.icon}</div>
              <div class="district-name">${district.name}</div>
              <div class="district-difficulty">
                ${'‚≠ê'.repeat(district.difficulty)} Zorluk
              </div>
              <div class="district-reward">
                üíé ${district.reward} Kristal
              </div>
            </div>
          `;
        }).join('');
      }

      attackDistrict(districtId) {
        this.audio.playClick();
        
        const district = ContentGenerator.districts.find(d => d.id === districtId);
        if (!district) return;
        
        if (this.player.conqueredDistricts.includes(districtId)) {
          this.showToast('‚úÖ Bu mahalle zaten senin!', 'success');
          return;
        }
        
        const activeRooster = this.player.getActiveRooster();
        if (!activeRooster || !activeRooster.canFight()) {
          this.showToast('‚ö†Ô∏è Sava≈üabilecek horozun yok!', 'warning');
          return;
        }
        
        const energyCost = district.difficulty * 25;
        if (!this.player.useEnergy(energyCost)) {
          this.showToast('‚ö†Ô∏è Yeterli enerji yok! (' + energyCost + '‚ö°)', 'warning');
          return;
        }
        
        // Ba≈üarƒ± ≈üansƒ± hesapla
        const roosterPower = activeRooster.getEffectivePower() + activeRooster.getEffectiveSpeed();
        const difficultyPower = district.difficulty * 40;
        const successChance = Math.min(90, Math.max(20, 50 + (roosterPower - difficultyPower)));
        
        const roll = Math.random() * 100;
        
        if (roll < successChance) {
          // Ba≈üarƒ±lƒ±
          this.player.conqueredDistricts.push(districtId);
          const crystals = this.globalEconomy.claimCrystals(district.reward);
          this.player.addCrystals(crystals);
          this.player.addPrestige(district.difficulty * 10);
          activeRooster.addXP(district.difficulty * 20);
          
          this.player.taskProgress.conquer2++;
          
          this.showToast(`üéâ ${district.name} fethedildi! +${crystals}üíé`, 'success');
          this.audio.playVictory();
        } else {
          // Ba≈üarƒ±sƒ±z
          activeRooster.addFatigue(20);
          this.showToast(`‚ùå ${district.name} savunmasƒ±nƒ± ge√ßemedin!`, 'error');
          this.audio.playDefeat();
        }
        
        this.renderCity();
        this.saveGame();
      }

      // ========== TRAINING ==========
      renderTraining() {
        this.selectedTrainingRooster = this.player.roosters[0];
        this.renderTrainingRoostersList();
      }

      renderTrainingRoostersList() {
        const container = document.getElementById('trainingRoostersList');
        
        if (this.player.roosters.length === 0) {
          container.innerHTML = `
            <div class="card" style="padding: 20px; text-align: center;">
              <p style="color: var(--text-secondary);">Hen√ºz horozun yok</p>
            </div>
          `;
          return;
        }
        
        container.innerHTML = this.player.roosters.map((rooster, index) => {
          const isSelected = this.selectedTrainingRooster === rooster;
          const status = rooster.getStatus();
          
          return `
            <div class="rooster-card element-${rooster.element.key}" 
                 onclick="game.selectTrainingRooster(${index})"
                 style="${isSelected ? 'border-color: var(--neon-cyan); box-shadow: var(--shadow-neon);' : ''}">
              <div class="rooster-avatar" style="width: 60px; height: 60px;">${rooster.generateAvatar()}</div>
              <div class="rooster-info">
                <div class="rooster-header">
                  <span class="rooster-name">${rooster.name}</span>
                  <span class="rooster-level">Lv.${rooster.level}</span>
                </div>
                <div class="rooster-stats" style="margin-top: 8px;">
                  <div class="rooster-stat">
                    <div class="rooster-stat-value">${rooster.stats.power}</div>
                    <div class="rooster-stat-label">G√º√ß</div>
                  </div>
                  <div class="rooster-stat">
                    <div class="rooster-stat-value">${rooster.stats.speed}</div>
                    <div class="rooster-stat-label">Hƒ±z</div>
                  </div>
                  <div class="rooster-stat">
                    <div class="rooster-stat-value">${Math.floor(rooster.fatigue)}%</div>
                    <div class="rooster-stat-label">Yorgun</div>
                  </div>
                </div>
              </div>
            </div>
          `;
        }).join('');
      }

      selectTrainingRooster(index) {
        this.audio.playClick();
        this.selectedTrainingRooster = this.player.roosters[index];
        this.renderTrainingRoostersList();
      }

      trainRooster(type) {
        this.audio.playClick();
        
        if (!this.selectedTrainingRooster) {
          this.showToast('‚ö†Ô∏è √ñnce bir horoz se√ß!', 'warning');
          return;
        }
        
        const costs = {
          power: 30,
          speed: 30,
          stamina: 30,
          recovery: 20
        };
        
        const cost = costs[type];
        
        if (!this.player.useEnergy(cost)) {
          this.showToast('‚ö†Ô∏è Yeterli enerji yok!', 'warning');
          return;
        }
        
        const rooster = this.selectedTrainingRooster;
        const gain = Math.floor(Math.random() * 3) + 3;
        
        switch (type) {
          case 'power':
            rooster.stats.power += gain;
            this.showToast(`üí™ G√º√ß +${gain}!`, 'success');
            break;
          case 'speed':
            rooster.stats.speed += gain;
            this.showToast(`‚ö° Hƒ±z +${gain}!`, 'success');
            break;
          case 'stamina':
            rooster.stats.stamina += gain;
            this.showToast(`‚ù§Ô∏è Dayanƒ±klƒ±lƒ±k +${gain}!`, 'success');
            break;
          case 'recovery':
            rooster.rest(30);
            rooster.morale = Math.min(100, rooster.morale + 20);
            this.showToast('üíä Dinlendirildi!', 'success');
            break;
        }
        
        rooster.addFatigue(10);
        this.player.taskProgress.train2++;
        
        // Level up kontrol√º
        if (rooster.stats.power + rooster.stats.speed + rooster.stats.stamina > rooster.level * 200) {
          if (rooster.levelUp()) {
            this.showToast(`üéâ ${rooster.name} Level ${rooster.level} oldu!`, 'success');
            this.player.taskProgress.levelUp++;
            this.audio.playCrystal();
          }
        }
        
        this.renderTrainingRoostersList();
        this.saveGame();
      }

      // ========== MARKET ==========
      renderMarket() {
        this.renderMarketItems();
      }

      setMarketCategory(category) {
        this.audio.playClick();
        this.marketCategory = category;
        
        document.querySelectorAll('.market-category').forEach(btn => {
          btn.classList.remove('active');
          if (btn.textContent.toLowerCase().includes(category.substring(0, 4))) {
            btn.classList.add('active');
          }
        });
        
        this.renderMarketItems();
      }

      renderMarketItems() {
        const container = document.getElementById('marketItems');
        
        let items = [];
        
        switch (this.marketCategory) {
          case 'roosters':
            items = ContentGenerator.marketRoosters.map((item, index) => ({
              ...item,
              icon: ContentGenerator.breeds[item.breed].emoji,
              id: 'rooster_' + index,
              type: 'rooster'
            }));
            break;
          case 'items':
            items = ContentGenerator.marketItems.map(item => ({
              ...item,
              type: 'item'
            }));
            break;
          case 'eggs':
            items = ContentGenerator.marketEggs.map(item => ({
              ...item,
              type: 'egg'
            }));
            break;
        }
        
        container.innerHTML = items.map(item => {
          const canAfford = this.player.crystals >= item.price;
          
          return `
            <div class="market-item">
              <div class="market-item-icon">${item.icon}</div>
              <div class="market-item-info">
                <div class="market-item-name">${item.name}</div>
                <div class="market-item-desc">${item.desc}</div>
              </div>
              <div class="market-item-price">
                <div class="market-item-cost">üíé ${item.price}</div>
                <button class="market-buy-btn" 
                        onclick="game.buyItem('${item.type}', '${item.id || item.name}')"
                        ${!canAfford ? 'disabled' : ''}>
                  ${canAfford ? 'Satƒ±n Al' : 'Yetersiz'}
                </button>
              </div>
            </div>
          `;
        }).join('');
      }

      buyItem(type, id) {
        this.audio.playClick();
        
        let item, price;
        
        switch (type) {
          case 'rooster':
            const roosterIndex = parseInt(id.split('_')[1]);
            item = ContentGenerator.marketRoosters[roosterIndex];
            price = item.price;
            
            if (!this.player.useCrystals(price)) {
              this.showToast('‚ö†Ô∏è Yeterli kristal yok!', 'warning');
              return;
            }
            
            const newRooster = new Rooster({
              name: ContentGenerator.getRandomName(),
              breed: item.breed
            });
            this.player.roosters.push(newRooster);
            this.showToast(`üêì ${newRooster.name} satƒ±n alƒ±ndƒ±!`, 'success');
            break;
            
          case 'item':
            item = ContentGenerator.marketItems.find(i => i.name === id);
            price = item.price;
            
            if (!this.player.useCrystals(price)) {
              this.showToast('‚ö†Ô∏è Yeterli kristal yok!', 'warning');
              return;
            }
            
            this.player.inventory.push(item);
            this.showToast(`üéí ${item.name} envanterine eklendi!`, 'success');
            break;
            
          case 'egg':
            item = ContentGenerator.marketEggs.find(i => i.name === id);
            price = item.price;
            
            if (!this.player.useCrystals(price)) {
              this.showToast('‚ö†Ô∏è Yeterli kristal yok!', 'warning');
              return;
            }
            
            // Yumurtadan horoz √ßƒ±k
            let breed = 0;
            if (item.id === 'rare') breed = Math.random() < 0.3 ? 2 : 1;
            else if (item.id === 'epic') breed = Math.random() < 0.2 ? 3 : 2;
            
            const hatchedRooster = new Rooster({
              name: ContentGenerator.getRandomName(),
              breed: breed
            });
            this.player.roosters.push(hatchedRooster);
            this.showToast(`üê£ ${hatchedRooster.name} yumurtadan √ßƒ±ktƒ±!`, 'success');
            this.audio.playCrystal();
            break;
        }
        
        this.updateHeader();
        this.renderMarketItems();
        this.saveGame();
      }

      // ========== BAZAAR (ADS) ==========
      renderBazaar() {
        const remaining = this.player.maxDailyAds - this.player.adsWatchedToday;
        document.getElementById('dailyAdStatus').textContent = `${remaining}/${this.player.maxDailyAds} Kalan`;
        
        document.getElementById('shieldAdCount').textContent = `${this.player.shieldAdsWatched}/3 izlendi`;
        document.getElementById('shieldAdProgress').style.width = (this.player.shieldAdsWatched / 3 * 100) + '%';
      }

      showBazaar() {
        this.navigate('bazaar');
      }

      watchAd(type) {
        this.audio.playClick();
        
        if (this.player.adsWatchedToday >= this.player.maxDailyAds) {
          this.showToast('‚ö†Ô∏è G√ºnl√ºk reklam limitine ula≈ütƒ±n!', 'warning');
          return;
        }
        
        this.adType = type;
        this.startAdSimulation();
      }

      startAdSimulation() {
        const adScreen = document.getElementById('adSimulation');
        const timer = document.getElementById('adTimer');
        const skipBtn = document.getElementById('adSkipBtn');
        
        adScreen.classList.add('active');
        skipBtn.classList.remove('ready');
        
        let seconds = 5;
        timer.textContent = seconds;
        
        const countdown = setInterval(() => {
          seconds--;
          timer.textContent = seconds;
          
          if (seconds <= 0) {
            clearInterval(countdown);
            skipBtn.classList.add('ready');
          }
        }, 1000);
      }

      skipAd() {
        const adScreen = document.getElementById('adSimulation');
        adScreen.classList.remove('active');
        
        this.player.adsWatchedToday++;
        this.player.stats.adsWatched++;
        this.player.taskProgress.watchAd++;
        this.globalEconomy.recordAdView();
        
        switch (this.adType) {
          case 'crystal':
            const crystals = this.globalEconomy.claimCrystals(15);
            this.player.addCrystals(crystals);
            this.showToast(`üíé +${crystals} Kristal kazandƒ±n!`, 'success');
            break;
            
          case 'energy':
            this.player.addEnergy(100);
            this.showToast('‚ö° +100 Enerji!', 'success');
            break;
            
          case 'shield':
            this.player.shieldAdsWatched++;
            if (this.player.shieldAdsWatched >= 3) {
              this.player.activateShield(1);
              this.player.shieldAdsWatched = 0;
              this.showToast('üõ°Ô∏è Koruma aktifle≈ütirildi! (1 saat)', 'success');
            } else {
              this.showToast(`üõ°Ô∏è Koruma i√ßin ${3 - this.player.shieldAdsWatched} reklam daha!`, 'success');
            }
            break;
            
          case 'boost':
            this.player.activateXPBoost(30);
            this.showToast('üöÄ 2x XP Boost aktif! (30 dk)', 'success');
            break;
        }
        
        this.audio.playCrystal();
        this.updateHeader();
        this.renderBazaar();
        this.saveGame();
      }

      // ========== TASKS ==========
      renderTasks() {
        this.renderTaskList();
      }

      setTaskTab(tab) {
        this.audio.playClick();
        this.taskTab = tab;
        
        document.querySelectorAll('.tasks-tab').forEach(btn => {
          btn.classList.remove('active');
        });
        event.target.classList.add('active');
        
        this.renderTaskList();
      }

      renderTaskList() {
        const container = document.getElementById('taskList');
        let tasks = [];
        
        switch (this.taskTab) {
          case 'daily':
            tasks = ContentGenerator.dailyTasks.map(task => ({
              ...task,
              progress: this.player.taskProgress[task.id] || 0
            }));
            break;
          case 'weekly':
            tasks = ContentGenerator.weeklyTasks.map(task => ({
              ...task,
              progress: this.player.taskProgress[task.id] || 0
            }));
            break;
          case 'achievements':
            tasks = ContentGenerator.achievements;
            break;
        }
        
        container.innerHTML = tasks.map(task => {
          const progress = task.progress || 0;
          const target = task.target || 1;
          const percent = Math.min(100, (progress / target) * 100);
          const completed = progress >= target;
          const claimed = task.claimed;
          
          let rewardText = '';
          if (task.reward) {
            if (task.reward.crystals) rewardText += `üíé ${task.reward.crystals}`;
            if (task.reward.energy) rewardText += `‚ö° ${task.reward.energy}`;
          }
          
          return `
            <div class="task-item">
              <div class="task-header">
                <div class="task-info">
                  <div class="task-title">${task.title}</div>
                  <div class="task-desc">${task.desc}</div>
                </div>
                <div class="task-reward">
                  <div class="task-reward-value">${rewardText}</div>
                </div>
              </div>
              ${this.taskTab !== 'achievements' ? `
                <div class="task-progress">
                  <div class="task-progress-bar">
                    <div class="task-progress-fill" style="width: ${percent}%"></div>
                  </div>
                  <div class="task-progress-text">${progress}/${target}</div>
                </div>
              ` : ''}
              <button class="task-claim-btn" 
                      onclick="game.claimTask('${task.id}')"
                      ${!completed || claimed ? 'disabled' : ''}>
                ${claimed ? 'Alƒ±ndƒ± ‚úì' : completed ? '√ñd√ºl√º Al' : 'Devam Ediyor...'}
              </button>
            </div>
          `;
        }).join('');
        
        // Badge g√ºncelle
        const claimable = tasks.filter(t => (t.progress || 0) >= (t.target || 1) && !t.claimed).length;
        document.getElementById('taskBadge').textContent = claimable;
        document.getElementById('taskBadge').style.display = claimable > 0 ? 'flex' : 'none';
      }

      claimTask(taskId) {
        this.audio.playCrystal();
        
        let task = ContentGenerator.dailyTasks.find(t => t.id === taskId);
        if (!task) task = ContentGenerator.weeklyTasks.find(t => t.id === taskId);
        if (!task) return;
        
        const progress = this.player.taskProgress[taskId] || 0;
        if (progress < task.target) return;
        
        // √ñd√ºl ver
        if (task.reward.crystals) {
          const crystals = this.globalEconomy.claimCrystals(task.reward.crystals);
          this.player.addCrystals(crystals);
        }
        if (task.reward.energy) {
          this.player.addEnergy(task.reward.energy);
        }
        
        // ƒ∞≈üaretle
        task.claimed = true;
        
        this.showToast('üéÅ G√∂rev √∂d√ºl√º alƒ±ndƒ±!', 'success');
        this.updateHeader();
        this.renderTaskList();
        this.saveGame();
      }

      // ========== MODAL ==========
      showModal(title, content, actions = []) {
        document.getElementById('modalTitle').textContent = title;
        document.getElementById('modalBody').innerHTML = content;
        
        const actionsContainer = document.getElementById('modalActions');
        actionsContainer.innerHTML = actions.map(action => `
          <button class="modal-btn ${action.class || 'primary'}" onclick="${action.action}">
            ${action.text}
          </button>
        `).join('');
        
        document.getElementById('modalOverlay').classList.add('active');
      }

      closeModal() {
        document.getElementById('modalOverlay').classList.remove('active');
      }

      // ========== TOAST ==========
      showToast(message, type = 'info') {
        const container = document.getElementById('toastContainer');
        
        const icons = {
          success: '‚úÖ',
          error: '‚ùå',
          warning: '‚ö†Ô∏è',
          info: '‚ÑπÔ∏è'
        };
        
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        toast.innerHTML = `
          <span class="toast-icon">${icons[type]}</span>
          <span class="toast-message">${message}</span>
        `;
        
        container.appendChild(toast);
        
        setTimeout(() => {
          toast.classList.add('hiding');
          setTimeout(() => {
            toast.remove();
          }, 300);
        }, 3000);
      }

      // ========== UTILS ==========
      formatNumber(num) {
        if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
        if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
        return num.toString();
      }
    }

    // ============================================
    // INIT
    // ============================================
    const game = new GameManager();
    
    // Service Worker (PWA desteƒüi)
    if ('serviceWorker' in navigator) {
      // SW kayƒ±t edilebilir
    }
    
    // Prevent pull-to-refresh
    document.body.addEventListener('touchmove', function(e) {
      if (e.target.closest('.screen')) {
        // Scroll izin ver
      }
    }, { passive: true });
    
    // Prevent double-tap zoom
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function(e) {
      const now = Date.now();
      if (now - lastTouchEnd <= 300) {
        e.preventDefault();
      }
      lastTouchEnd = now;
    }, false);
    
    console.log('üêì Horoz ƒ∞mparatorluƒüu: Cyber Arena ba≈ülatƒ±ldƒ±!');
  </script>
</body>
</html>
